/*
 Modifications performed to this file by anyone other than Solid State Networks
 are unsupported and may void your software warranty.
*/
$(document).ready(function(){host.assert("3.6.8.1"===app.expandString("{AppVersion}"),"Invalid application version")});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d;c=this.length;d=Number(b)||0;d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=c);d<c;){if(hasOwnProperty(this,d)&&this[d]===a)return d;d+=1}return-1});Array.prototype.removeIndex||(Array.prototype.removeIndex=function(a){this.splice(a,1)});
Array.prototype.removeElement||(Array.prototype.removeElement=function(a){a=this.indexOf(a);if(a>=0){this.splice(a,1);return true}return false});Array.prototype.getUnique||(Array.prototype.getUnique=function(){var a={},b=[],c=0,d;for(d=this.length;c<d;c=c+1)if(!hasOwnProperty(a,this[c])){b.push(this[c]);a[this[c]]=1}return b});
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;c=0;for(d=this.length;c<d;){a.call(b,this[c],c,this);c=c+1}},Array.forEach=function(a,b,c){a.forEach(b,c)});Array.prototype.forEachReverse||(Array.prototype.forEachReverse=function(a,b){var c;for(c=this.length-1;c>=0;){a.call(b,this[c],c,this);c=c-1}},Array.forEachReverse=function(a,b,c){a.forEachReverse(b,c)});String.prototype.replaceAll||(String.prototype.replaceAll=function(a,b){return this.split(a).join(b)});
String.prototype.toBoolean||(String.prototype.toBoolean=function(){return this.toLowerCase()==="true"||this.toLowerCase()==="1"});String.prototype.trimChars||(String.prototype.trimChars=function(a){for(var b=0,c=0,b=0;b<this.length;b=b+1)if(a.indexOf(this.charAt(b))===-1)break;for(c=this.length-1;c>=b;c=c-1)if(a.indexOf(this.charAt(c))===-1){c=c+1;break}return this.substring(b,c)});
String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return hasOwnProperty(a,c)?a[c]:b})});String.prototype.endsWith||(String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1});String.prototype.beginsWith||(String.prototype.beginsWith=function(a){return this.indexOf(a)===0});function isNull(a){return a instanceof jQuery&&a.length===0?true:typeof a==="undefined"||a===null}
function thisIs(a,b){return(a&b)!=0}function thisIsNot(a,b){return(a&b)==0}function hasOwnProperty(a,b){var c;if(getObjectType(b)=="array"){for(c=0;c<b.length;c=c+1)if(!hasOwnProperty(a,b[c]))return false;return true}return!isNull(a.hasOwnProperty)?a.hasOwnProperty(b):Object.prototype.hasOwnProperty.call(a,b)}
function deepCopy(a){var b,c,d;switch(getObjectType(a)){case "object":b={};for(c in a)hasOwnProperty(a,c)&&(b[c]=deepCopy(a[c]));return b;case "array":b=[];d=a.length;for(c=0;c<d;c=c+1)b[c]=deepCopy(a[c]);return b}return a}
function mergeObjectProperties(a,b,c,d){var e,f,g;isNull(c)&&(c=false);isNull(d)&&(d=true);if(isNull(b))return a;switch(getObjectType(b)){case "object":for(e in b)a[e]=hasOwnProperty(a,e)?mergeObjectProperties(a[e],b[e],c,d):deepCopy(b[e]);break;case "array":f=b.length;for(e=0;e<f;e=e+1){g={};a.push(mergeObjectProperties(g,b[e],c,d))}break;default:d===true&&host.assert(c===true,"mergeObjectProperties failed to overwrite ({0}:{1})".format(a,b));c===true&&(a=b)}return a}
function getObjectProperties(a){var b,c;c=[];for(b in a)hasOwnProperty(a,b)&&c.push(b);return c}function saveObjectToFile(a,b){var c,d,e,f,g,h;d=JSON.stringify(a);g=d.length;f=0;e=createTextFileWriter();c=false;if(e.open(b)===true){for(c=true;c===true&&f<g;){h=d.substr(f,2048);h=e.write(h);if(h<=0){c=false;break}f=f+h}e.close()}e.release();return c}
function loadObjectFromFile(a,b){var c,d,e,f,g;if(window.platform.fileExists(a)===false)b!==null&&b({loadedObject:null});else{d=createTextFileReader();d.setFileName(a);c="";f=notificationCenter.addInstanceObserver("TextFileReader","Read",d,function(a,b){c=c+b.text});g=notificationCenter.addInstanceObserver("TextFileReader","Complete",d,function(a,d){e=null;f.release();g.release();d.successful===true&&(e=interop.parseJSON(c));b!==null&&b({loadedObject:e});e=null;a.release()});d.start()}}
function getObjectType(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function whileInterval(a,b,c){var d,e;return d=setInterval(function(){for(e=0;e<b;){if(!a()){clearInterval(d);break}e=e+1}},c)}var NativeInterop;NativeInterop||(NativeInterop=document.NativeInterop);
(function(){function a(){this.activeInteropLibs=[];this.instanceArray=[]}a.prototype={parseJSON:function(a){try{return isNull(a)||a.length===0?null:JSON.parse(a)}catch(c){isNull(window.host)||host.assert(false,"Failed to parse json: {0}".format(c.message));return null}},isInteropLoaded:function(a){return this.activeInteropLibs.indexOf(a)>=0},createInstance:function(a,c){try{var d=null,e=NativeInterop.createInstance(a);if(isNull(e))host.assert(false,"Failed to create instance ({0})".format(a));else{d=
new c(e);this.instanceArray[e]=d}return d}catch(f){isNull(window.host)||host.assert(false,"Failed to create instance ({0})".format(a));return null}},hasInstance:function(a){return NativeInterop.hasInstance(a)},releaseInstance:function(a){NativeInterop.releaseInstance(a);delete this.instanceArray[a]},instanceById:function(a){return this.instanceArray[a]},invoke:function(a,c){try{var d=null,e=interop.parseJSON(NativeInterop.invoke(a,JSON.stringify(c)));if(isNull(e))host.assert(false,"Unable to invoke method ({0}) ({1})".format(a,
JSON.stringify(c)));else{hasOwnProperty(c,"inOutParams")&&hasOwnProperty(e,"inOutParams")&&mergeObjectProperties(c.inOutParams,e.inOutParams,true);if(hasOwnProperty(e,"returnValue"))d=e.returnValue}return d}catch(f){isNull(window.host)||host.assert(false,"Unhandled exception attempting to invoke: {0}".format(f.message));return null}}};window.interop=new a})();
function DispatchInteropCallback(a,b){var c=interop.parseJSON(b),d=interop.instanceById(a);isNull(d)||notificationCenter.fire(c.typename,c.method,d,c);return JSON.stringify(c)}
(function(){function a(){this.notificationObservers={};this.instanceId="Global"}a.prototype.ensureCreated=function(a,c,d){var e;if(hasOwnProperty(this.notificationObservers,a)===false){e={};this.notificationObservers[a]=e}else e=this.notificationObservers[a];if(hasOwnProperty(e,c)===false){a={};e[c]=a}else a=e[c];if(hasOwnProperty(a,d)===false){c=[];a[d]=c}else c=a[d];return c};a.prototype.addObserver=function(a,c,d){return this.addInstanceObserver(a,c,this,d)};a.prototype.addInstanceObserver=function(a,
c,d,e){if(hasOwnProperty(d,"instanceId")===false){host.assert(false,"NotificationCenter requires instance to have unique instanceId");return{release:function(){}}}this.ensureCreated(a,c,d.instanceId).push(e);return{release:function(){notificationCenter.removeInstanceObserver(a,c,d,e)}}};a.prototype.removeInstanceObserver=function(a,c,d,e){this.ensureCreated(a,c,d.instanceId).removeElement(e)===false&&(d===this?host.assert(false,"NotificationCenter unable to remove global observer {0} {1}".format(a,
c)):host.assert(false,"NotificationCenter unable to remove instance observer {0} {1} {2}".format(a,c,d.instanceId)));this.notificationObservers[a][c][d.instanceId].length===0&&delete this.notificationObservers[a][c][d.instanceId]};a.prototype.fireAfterDelay=function(a,c,d,e,f){setTimeout(function(){notificationCenter.fire(a,c,e,f)},d)};a.prototype.fire=function(a,c,d,e){if(hasOwnProperty(this.notificationObservers,a)!==false&&hasOwnProperty(this.notificationObservers[a],c)!==false)if(hasOwnProperty(d,
"instanceId")===false)host.assert(false,"NotificationCenter requires sender to have unique instanceId");else{hasOwnProperty(this.notificationObservers[a][c],d.instanceId)===true&&this.notificationObservers[a][c][d.instanceId].forEachReverse(function(a){if(!isNull(a))try{a(d,e)}catch(c){host.assert(false,"Notification center caught unhandled exception: {0}".format(c.message))}});hasOwnProperty(this.notificationObservers[a][c],this.instanceId)===true&&this.notificationObservers[a][c][this.instanceId].forEachReverse(function(a){if(!isNull(a))try{a(d,
e)}catch(c){host.assert(false,"Notification center caught unhandled exception: {0}".format(c.message))}})}};window.notificationCenter=new a})();
(function(){function a(a){this.instanceId=a}var b;a.prototype.release=function(){interop.releaseInstance(this.instanceId)};a.prototype.getSecurityEnabled=function(){return interop.invoke(this.instanceId,{method:"getSecurityEnabled"})};a.prototype.getDebugFilename=function(){return interop.invoke(this.instanceId,{method:"getDebugFilename"})};a.prototype.getDebugFlags=function(){return interop.invoke(this.instanceId,{method:"getDebugFlags"})};a.prototype.getLogExpirationDays=function(){return interop.invoke(this.instanceId,
{method:"getLogExpirationDays"})};a.prototype.setLogExpirationDays=function(a){return interop.invoke(this.instanceId,{method:"setLogExpirationDays",value:a})};a.prototype.getExitCode=function(){return interop.invoke(this.instanceId,{method:"getExitCode"})};a.prototype.setExitCode=function(a){return interop.invoke(this.instanceId,{method:"setExitCode",value:a})};a.prototype.getStartTime=function(){return interop.invoke(this.instanceId,{method:"getStartTime"})};a.prototype.getCurrentTime=function(){return interop.invoke(this.instanceId,
{method:"getCurrentTime"})};a.prototype.getRunningTime=function(){return interop.invoke(this.instanceId,{method:"getRunningTime"})};a.prototype.getElevated=function(){return interop.invoke(this.instanceId,{method:"getElevated"})};a.prototype.getRemoveLocalStorage=function(){return interop.invoke(this.instanceId,{method:"getRemoveLocalStorage"})};a.prototype.setRemoveLocalStorage=function(a){return interop.invoke(this.instanceId,{method:"setRemoveLocalStorage",value:a})};a.prototype.getLanguage=function(){return interop.invoke(this.instanceId,
{method:"getLanguage"})};a.prototype.setLanguage=function(a){return interop.invoke(this.instanceId,{method:"setLanguage",value:a})};a.prototype.getCountry=function(){return interop.invoke(this.instanceId,{method:"getCountry"})};a.prototype.setCountry=function(a){return interop.invoke(this.instanceId,{method:"setCountry",value:a})};a.prototype.getRestart=function(){return interop.invoke(this.instanceId,{method:"getRestart"})};a.prototype.setRestart=function(a){return interop.invoke(this.instanceId,
{method:"setRestart",value:a})};a.prototype.getRestartElevated=function(){return interop.invoke(this.instanceId,{method:"getRestartElevated"})};a.prototype.setRestartElevated=function(a){return interop.invoke(this.instanceId,{method:"setRestartElevated",value:a})};a.prototype.getCommandLine=function(){return interop.invoke(this.instanceId,{method:"getCommandLine"})};a.prototype.setCommandLine=function(a){return interop.invoke(this.instanceId,{method:"setCommandLine",value:a})};a.prototype.implode=
function(){return interop.invoke(this.instanceId,{method:"implode"})};a.prototype.setDebugLogging=function(a,d){return interop.invoke(this.instanceId,{method:"setDebugLogging",filename:a,flags:d})};a.prototype.isCommandFieldSet=function(a){return interop.invoke(this.instanceId,{method:"isCommandFieldSet",commandField:a})};a.prototype.getCommandFieldByName=function(a){return interop.invoke(this.instanceId,{method:"getCommandFieldByName",commandField:a})};a.prototype.getCommandFieldByName=function(a){return interop.invoke(this.instanceId,
{method:"getCommandFieldByName",commandField:a})};a.prototype.getSkinFileModifiedEncoded=function(a){return interop.invoke(this.instanceId,{method:"getSkinFileModifiedEncoded",filename:a})};a.prototype.base64Encode=function(a){return interop.invoke(this.instanceId,{method:"base64Encode",utf8String:a})};a.prototype.base64Decode=function(a){return interop.invoke(this.instanceId,{method:"base64Decode",encoded:a})};a.prototype.expandString=function(a){return interop.invoke(this.instanceId,{method:"expandString",
expand:a})};a.prototype.convertToEntitizedString=function(a){return interop.invoke(this.instanceId,{method:"convertToEntitizedString",utf8string:a})};a.prototype.convertFromEntitizedString=function(a){return interop.invoke(this.instanceId,{method:"convertFromEntitizedString",entitizedString:a})};a.prototype.getConfig=function(a,d){return interop.invoke(this.instanceId,{method:"getConfig",key:a,defaultValue:d})};a.prototype.getCredential=function(a,d){return interop.invoke(this.instanceId,{method:"getCredential",
target:a,inOutParams:d})};a.prototype.setCredential=function(a,d,b){return interop.invoke(this.instanceId,{method:"setCredential",target:a,username:d,password:b})};a.prototype.removeCredential=function(a){return interop.invoke(this.instanceId,{method:"removeCredential",target:a})};a.prototype.getWebCredential=function(a,d,b,f){return interop.invoke(this.instanceId,{method:"getWebCredential",type:a,host:d,realm:b,inOutParams:f})};a.prototype.setWebCredential=function(a,b,e,f,g){return interop.invoke(this.instanceId,
{method:"setWebCredential",type:a,host:b,realm:e,username:f,password:g})};a.prototype.removeWebCredential=function(a,b,e){return interop.invoke(this.instanceId,{method:"removeWebCredential",type:a,host:b,realm:e})};a.prototype.authorizeUrl=function(a){return interop.invoke(this.instanceId,{method:"authorizeUrl",url:a})};a.prototype.loadInterop=function(a){return interop.invoke(this.instanceId,{method:"loadInterop",fileName:a})};a.prototype.unloadInterop=function(a){return interop.invoke(this.instanceId,
{method:"unloadInterop",fileName:a})};a.prototype.debugPrint=function(a){return interop.invoke(this.instanceId,{method:"debugPrint",message:a})};a.prototype.remoteNotify=function(a){return interop.invoke(this.instanceId,{method:"remoteNotify",notification:a})};a.prototype.remoteIsAttached=function(){return interop.invoke(this.instanceId,{method:"remoteIsAttached"})};a.prototype.remoteDetach=function(){return interop.invoke(this.instanceId,{method:"remoteDetach"})};a.prototype.apiMessage=function(a){return interop.invoke(this.instanceId,
{method:"apiMessage",message:a})};a.prototype.openWindow=function(a){return interop.invoke(this.instanceId,{method:"openWindow",windowConfigUrl:a})};a.prototype.addMacro=function(a,b){return interop.invoke(this.instanceId,{method:"addMacro",key:a,value:b})};a.prototype.closeAll=function(){return interop.invoke(this.instanceId,{method:"closeAll"})};a.prototype.crash=function(){return interop.invoke(this.instanceId,{method:"crash"})};window.app=interop.createInstance("SSN.App",a);b=notificationCenter.addObserver("Host",
"DidUnload",function(){b.release();window.app.release();window.app=null})})();function Tasks(){this.instanceId=app.expandString("{Guid}");this.tasks={};this.activeTasks=[]}Tasks.prototype.cancelAll=function(){this.activeTasks.forEachReverse(function(a){a.debugPrint("Cancelling\n");a.error("UI_UserAbort");a.complete()})};Tasks.prototype.exists=function(a){return hasOwnProperty(this.tasks,a)};
Tasks.prototype.add=function(a,b){hasOwnProperty(this.tasks,a)?host.assert(false,"Task ({0}) already exists".format(a)):this.tasks[a]=b};Tasks.prototype.remove=function(a){hasOwnProperty(this.tasks,a)?delete this.tasks[a]:host.assert(false,"Task ({0}) does not exist".format(a))};Tasks.prototype.loadFromObject=function(a){mergeObjectProperties(this.tasks,a)};
Tasks.prototype.load=function(a,b){var c=this;host.extractJSON(app.expandString(a),function(a){var e=false;if(!isNull(a)){mergeObjectProperties(c.tasks,a);e=true}isNull(b)||b({successful:e})})};
Tasks.prototype.create=function(a,b,c,d,e){var f={},g={},h=this;if(!hasOwnProperty(this.tasks,a))return null;this.activeTasks.push(g);g.errors=[];g.warnings=[];g.instanceId=app.expandString("{Guid}");g.start=function(){g.startTime=(new Date).getTime();g.completeTime=null;g.args=Tasks.expandValue(g,g.args,g.args);notificationCenter.fireAfterDelay("Task","Start",0,g,{})};g.getStringArgument=function(a){return hasOwnProperty(g.args,a)===true?getObjectType(g.args[a])==="array"?app.expandString(g.args[a].join("")):
app.expandString(g.args[a]):""};g.debugPrint=function(a){app.debugPrint("{0} ({1}) ({2}): {3}".format(g.name,g.args.type,g.instanceId.substring(0,4),a))};g.assertArgument=function(a){host.assert(hasOwnProperty(g.args,a),"{0} not defined for ({1}) in ({2})".format(a,g.args.type,g.name))};g.isComplete=function(){return!isNull(g.completeTime)};g.getRunningTime=function(){return isNull(g.startTime)?0:isNull(g.completeTime)?(new Date).getTime()-g.startTime():g.completeTime-g.startTime};g.getFirstWarningMessage=
function(){return g.warnings.length>0?host.getLanguageString(g.warnings[0].message):null};g.getLastWarningMessage=function(){return g.warnings.length>0?host.getLanguageString(g.warnings[g.warnings.length-1].message):null};g.hasWarning=function(a){var c=0;if(isNull(a))return this.warnings.length>0;for(c in this.warnings)if(this.warnings[c].message==a)return true;return false};g.clearWarnings=function(){this.warnings=[]};g.warning=function(a){g.warnings.push({source:g.name,message:a});notificationCenter.fire("Task",
"Warning",g,{message:a})};g.getFirstErrorMessage=function(){return g.errors.length>0?host.getLanguageString(g.errors[0].message):null};g.getLastErrorMessage=function(){return g.errors.length>0?host.getLanguageString(g.errors[g.errors.length-1].message):null};g.hasError=function(a){var c=0;if(isNull(a))return this.errors.length>0;for(c in this.errors)if(this.errors[c].message==a)return true;return false};g.clearErrors=function(){this.errors=[]};g.error=function(a){if(hasOwnProperty(g.args,"ignoreError")&&
g.args.ignoreError===true)g.debugPrint("Ignoring task error ({0})\n".format(a));else{g.errors.push({source:g.name,message:a});notificationCenter.fire("Task","Error",g,{message:a})}};g.find=function(a,c){var b=this;for(isNull(c)||(b=c);!isNull(b);){if(b.controller instanceof a||b.view instanceof a)return b;b=b.parent}return null};g.findAncestor=function(a){this.find(a,this.parent)};g.runSubAction=function(a,c,b){hasOwnProperty(g.args,a)?g.runSubTask(g.args[a],c,b):setTimeout(function(){b(null,{})},
0)};g.runSubTask=function(a,c,d){var e,f=null,f=h.create(app.expandString(a),b,this.controllerCreator,this.viewCreator,c);if(isNull(f))setTimeout(function(){d(f,{})},0);else{f.parent=g;notificationCenter.fire("Task","SubTaskCreate",g,{subTask:f});e=notificationCenter.addInstanceObserver("Task","Complete",f,function(a,c){notificationCenter.fire("Task","SubTaskComplete",g,{subTask:f,args:c});e.release();mergeObjectProperties(g.errors,f.errors);mergeObjectProperties(g.warnings,f.warnings);d(f,c)});f.start()}};
g.complete=function(a){var c={},d="failure";if(!g.isComplete()&&!g.isCompleting){g.isCompleting=true;isNull(a)||mergeObjectProperties(c,a);g.hasError()===false&&(d="success");this.runSubAction(d,null,function(){g.runSubAction("complete",null,function(){g.isCompleting=false;g.completeTime=(new Date).getTime();notificationCenter.fire("Task","Complete",g,c);h.activeTasks.removeElement(g);if(isNull(g.view)&&!isNull(g.controller)){g.controller.release();g.controlller=null}if(!isNull(g.view)&&b===true){g.view.release();
g.view=null}})})}};g.name=a;g.args={};g.controllerCreator=c;g.viewCreator=d;mergeObjectProperties(g.args,this.tasks[a]);isNull(e)||mergeObjectProperties(g.args,e);f=g.args;c(g,f);host.assert(hasOwnProperty(g,"controller"),"Task controller not found for "+f.type);d(g,f);notificationCenter.fire("Task","Create",g,{});return g};
Tasks.getValue=function(a,b,c){var d=null,e=true;c.forEach(function(f){if(isNull(d)){if(e===true){e=false;if(f.charAt(0)==="@"){g=f.substring(1,f.length);switch(g){case "this":d=a;break;case "args":d=b;break;default:isNull(window[g])||(d=window[g])}}}}else if(hasOwnProperty(d,f))d=d[f];else if(f.indexOf("{")>-1&&getObjectType(d.expandString)==="function")d=d.expandString(f);else if(f.indexOf("[")==0&&f.indexOf("]")>0&&(getObjectType(d)==="array"||getObjectType(d)==="object")){var g=f.substring(f.indexOf("[")+
1,f.indexOf("]"));getObjectType(d)==="array"?d=d[parseInt(g)]:hasOwnProperty(d,g)&&(d=d[g])}else{g="get"+f.charAt(0).toUpperCase()+f.slice(1);if(getObjectType(d[g])==="function"){d=d[g]();if(getObjectType(d)==="string"){f=d;try{d=JSON.parse(d)}catch(h){d=f}}}else{host.assert(false,"Path not found ({0}) in ({1})".format(f,c.join(".")));d=null}}});return d};
Tasks.replaceNestingBraces=function(a){var b=0,c,d="",e,f="",g=[];for(c=0;c<a.length;c=c+1){e=a.charAt(c);switch(e){case "{":b=b+1;break;case "}":b=b-1}if(b>0)d=d+e;else if(d.length>0){d=d+e;f=f+("{"+g.length+"}");g.push(d);d=""}else f=f+e}return{str:f,args:g}};
Tasks.splitIntoPath=function(a){var b,c=[];b=Tasks.replaceNestingBraces(a);a=b.str.match(/(\\.|[^\.])+/g);isNull(a)||a.forEach(function(a){a=a.replaceAll("\\.",".").replace(/\{(\d+)\}/g,function(a,c){return hasOwnProperty(b.args,c)?b.args[c]:a});c.push(a)});return c};
Tasks.expandValue=function(a,b,c){var d=null,e;if(isNull(c))return c;if(getObjectType(c.forEach)==="function"){d=[];c.forEach(function(c){d.push(Tasks.expandValue(a,b,c))});return d}if(getObjectType(c.split)==="function")d=Tasks.getValue(a,b,Tasks.splitIntoPath(c));else if(getObjectType(c)==="object"){for(e in c)hasOwnProperty(c,e)&&(c[e]=Tasks.expandValue(a,b,c[e]));return c}return isNull(d)?c:d};window.taskControllers={};window.taskViews={};
window.registerTaskController=function(a,b){window.taskControllers[a.toLowerCase()]=b};window.registerTaskView=function(a,b){window.taskViews[a.toLowerCase()]=b};window.taskControllerCreator=function(a,b){host.assert(hasOwnProperty(b,"type"),"Task type not found for "+a.name);if(hasOwnProperty(window.taskControllers,b.type.toLowerCase()))a.controller=new (window.taskControllers[b.type.toLowerCase()])(a,b)};
window.taskViewCreator=function(a,b){host.assert(hasOwnProperty(b,"type"),"Task type not found for "+a.name);if(hasOwnProperty(window.taskViews,b.type.toLowerCase()))a.view=new (window.taskViews[b.type.toLowerCase()])(a,b)};
(function(){function a(a){this.instanceId=a}var b;a.prototype.release=function(){interop.releaseInstance(this.instanceId)};a.prototype.getX=function(){return interop.invoke(this.instanceId,{method:"getX"})};a.prototype.getY=function(){return interop.invoke(this.instanceId,{method:"getY"})};a.prototype.getWidth=function(){return interop.invoke(this.instanceId,{method:"getWidth"})};a.prototype.getHeight=function(){return interop.invoke(this.instanceId,{method:"getHeight"})};a.prototype.getMinWidth=
function(){return interop.invoke(this.instanceId,{method:"getMinWidth"})};a.prototype.getMinHeight=function(){return interop.invoke(this.instanceId,{method:"getMinHeight"})};a.prototype.getUseNotificationArea=function(){return interop.invoke(this.instanceId,{method:"getUseNotificationArea"})};a.prototype.setUseNotificationArea=function(a){return interop.invoke(this.instanceId,{method:"setUseNotificationArea",value:a})};a.prototype.getMinimizeToNotificationArea=function(){return interop.invoke(this.instanceId,
{method:"getMinimizeToNotificationArea"})};a.prototype.setMinimizeToNotificationArea=function(a){return interop.invoke(this.instanceId,{method:"setMinimizeToNotificationArea",value:a})};a.prototype.getCanActivate=function(){return interop.invoke(this.instanceId,{method:"getCanActivate"})};a.prototype.setCanActivate=function(a){return interop.invoke(this.instanceId,{method:"setCanActivate",value:a})};a.prototype.getWindowFrame=function(){return interop.invoke(this.instanceId,{method:"getWindowFrame"})};
a.prototype.setWindowFrame=function(a){return interop.invoke(this.instanceId,{method:"setWindowFrame",value:a})};a.prototype.getTitle=function(){return interop.invoke(this.instanceId,{method:"getTitle"})};a.prototype.setTitle=function(a){return interop.invoke(this.instanceId,{method:"setTitle",value:a})};a.prototype.isVisible=function(){return interop.invoke(this.instanceId,{method:"isVisible"})};a.prototype.setOrigin=function(a,b){return interop.invoke(this.instanceId,{method:"setOrigin",x:a,y:b})};
a.prototype.setSize=function(a,b){return interop.invoke(this.instanceId,{method:"setSize",width:a,height:b})};a.prototype.setMinSize=function(a,b){return interop.invoke(this.instanceId,{method:"setMinSize",width:a,height:b})};a.prototype.setTaskbarProgress=function(a){return interop.invoke(this.instanceId,{method:"setTaskbarProgress",value:a})};a.prototype.setTaskbarOverlay=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"setTaskbarOverlay",x:a,y:b,width:e,height:f})};a.prototype.setSmallIcon=
function(a,b,e,f){return interop.invoke(this.instanceId,{method:"setSmallIcon",x:a,y:b,width:e,height:f})};a.prototype.setBigIcon=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"setBigIcon",x:a,y:b,width:e,height:f})};a.prototype.setNotificationAreaIcon=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"setNotificationAreaIcon",x:a,y:b,width:e,height:f})};a.prototype.browseForFolder=function(a,b){return interop.invoke(this.instanceId,{method:"browseForFolder",text:a,
startPath:b})};a.prototype.browseForFile=function(a,b,e,f,g){return interop.invoke(this.instanceId,{method:"browseForFile",text:a,startPath:b,startFile:e,fileTypeDesc:f,fileTypeExt:g})};a.prototype.setCursor=function(a){return interop.invoke(this.instanceId,{method:"setCursor",cursor:a})};a.prototype.prompt=function(a,b,e){return interop.invoke(this.instanceId,{method:"prompt",text:a,caption:b,type:e})};a.prototype.sendMessage=function(a){return interop.invoke(this.instanceId,{method:"sendMessage",
message:a})};a.prototype.beginMove=function(){return interop.invoke(this.instanceId,{method:"beginMove"})};a.prototype.beginSize=function(){return interop.invoke(this.instanceId,{method:"beginSize"})};a.prototype.center=function(){return interop.invoke(this.instanceId,{method:"center"})};a.prototype.show=function(){return interop.invoke(this.instanceId,{method:"show"})};a.prototype.hide=function(){return interop.invoke(this.instanceId,{method:"hide"})};a.prototype.minimize=function(){return interop.invoke(this.instanceId,
{method:"minimize"})};a.prototype.restore=function(){return interop.invoke(this.instanceId,{method:"restore"})};a.prototype.close=function(){return interop.invoke(this.instanceId,{method:"close"})};a.prototype.getConfig=function(a,b){return interop.invoke(this.instanceId,{method:"getConfig",key:a,defaultValue:b})};a.prototype.setContextMenu=function(a){return interop.invoke(this.instanceId,{method:"setContextMenu",menu:a})};a.prototype.setContextMenuSelect=function(a,b){return interop.invoke(this.instanceId,
{method:"setContextMenuSelect",id:a,select:b})};a.prototype.saveImage=function(a){return interop.invoke(this.instanceId,{method:"saveImage",filename:a})};a.prototype.simulateKeyDown=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"simulateKeyDown",virtualKey:a,character:b,extended:e,modifier:f})};a.prototype.simulateKeyUp=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"simulateKeyUp",virtualKey:a,character:b,extended:e,modifier:f})};a.prototype.simulateCharacter=function(a,
b,e,f){return interop.invoke(this.instanceId,{method:"simulateCharacter",virtualKey:a,character:b,extended:e,modifier:f})};a.prototype.simulateMouseMove=function(a,b,e){return interop.invoke(this.instanceId,{method:"simulateMouseMove",x:a,y:b,leave:e})};a.prototype.simulateMouseDown=function(a,b,e){return interop.invoke(this.instanceId,{method:"simulateMouseDown",x:a,y:b,button:e})};a.prototype.simulateMouseUp=function(a,b,e){return interop.invoke(this.instanceId,{method:"simulateMouseUp",x:a,y:b,
button:e})};a.prototype.simulateMouseWheel=function(a,b,e){return interop.invoke(this.instanceId,{method:"simulateMouseWheel",x:a,y:b,delta:e})};a.prototype.simulateUndo=function(){return interop.invoke(this.instanceId,{method:"simulateUndo"})};a.prototype.simulateRedo=function(){return interop.invoke(this.instanceId,{method:"simulateRedo"})};a.prototype.simulateCut=function(){return interop.invoke(this.instanceId,{method:"simulateCut"})};a.prototype.simulateCopy=function(){return interop.invoke(this.instanceId,
{method:"simulateCopy"})};a.prototype.simulatePaste=function(){return interop.invoke(this.instanceId,{method:"simulatePaste"})};a.prototype.simulateDelete=function(){return interop.invoke(this.instanceId,{method:"simulateDelete"})};a.prototype.simulateSelectAll=function(){return interop.invoke(this.instanceId,{method:"simulateSelectAll"})};a.prototype.notify=function(a,b,e){return interop.invoke(this.instanceId,{method:"notify",type:a,caption:b,message:e})};window.attachSkinWindow=function(c){return new a(c)};
window.skinWindow=interop.createInstance("SSN.SkinWindow",a);b=notificationCenter.addObserver("Host","DidUnload",function(){b.release();window.skinWindow.release();window.skinWindow=null})})();
(function(){function a(a){this.instanceId=a}var b;a.prototype.release=function(){interop.releaseInstance(this.instanceId)};a.prototype.getFileReadLimit=function(){return interop.invoke(this.instanceId,{method:"getFileReadLimit"})};a.prototype.setFileReadLimit=function(a){return interop.invoke(this.instanceId,{method:"setFileReadLimit",value:a})};a.prototype.getFileWriteLimit=function(){return interop.invoke(this.instanceId,{method:"getFileWriteLimit"})};a.prototype.setFileWriteLimit=function(a){return interop.invoke(this.instanceId,
{method:"setFileWriteLimit",value:a})};a.prototype.dateEncodedToRFC1123=function(a){return interop.invoke(this.instanceId,{method:"dateEncodedToRFC1123",date:a})};a.prototype.fileModifiedEncoded=function(a){return interop.invoke(this.instanceId,{method:"fileModifiedEncoded",fileName:a})};a.prototype.fileCreationEncoded=function(a){return interop.invoke(this.instanceId,{method:"fileCreationEncoded",fileName:a})};a.prototype.fileExists=function(a){return interop.invoke(this.instanceId,{method:"fileExists",
fileName:a})};a.prototype.directoryExists=function(a){return interop.invoke(this.instanceId,{method:"directoryExists",directory:a})};a.prototype.directoryCreate=function(a){return interop.invoke(this.instanceId,{method:"directoryCreate",directory:a})};a.prototype.collapseEmptyDirectories=function(a){return interop.invoke(this.instanceId,{method:"collapseEmptyDirectories",sourceDirectory:a})};a.prototype.fileEraseRecursive=function(a,b){return interop.invoke(this.instanceId,{method:"fileEraseRecursive",
sourceDirectory:a,fileName:b})};a.prototype.directoryErase=function(a){return interop.invoke(this.instanceId,{method:"directoryErase",fileName:a})};a.prototype.fileErase=function(a){return interop.invoke(this.instanceId,{method:"fileErase",fileName:a})};a.prototype.registryKeyPathExists=function(a,b,e){return interop.invoke(this.instanceId,{method:"registryKeyPathExists",view:a,type:b,keyPath:e})};a.prototype.registryDeleteKey=function(a,b,e){return interop.invoke(this.instanceId,{method:"registryDeleteKey",
view:a,type:b,keyPath:e})};a.prototype.registryDeleteValue=function(a,b,e,f){return interop.invoke(this.instanceId,{method:"registryDeleteValue",view:a,type:b,keyPath:e,name:f})};a.prototype.setRegistryString=function(a,b,e,f,g,h){return interop.invoke(this.instanceId,{method:"setRegistryString",view:a,security:b,type:e,keyPath:f,name:g,value:h})};a.prototype.getRegistryString=function(a,b,e,f,g){return interop.invoke(this.instanceId,{method:"getRegistryString",view:a,type:b,keyPath:e,name:f,defaultValue:g})};
a.prototype.setRegistryInt32=function(a,b,e,f,g,h){return interop.invoke(this.instanceId,{method:"setRegistryInt32",view:a,security:b,type:e,keyPath:f,name:g,value:h})};a.prototype.getRegistryInt32=function(a,b,e,f,g){return interop.invoke(this.instanceId,{method:"getRegistryInt32",view:a,type:b,keyPath:e,name:f,defaultValue:g})};a.prototype.shellOpen=function(a){return interop.invoke(this.instanceId,{method:"shellOpen",path:a})};a.prototype.getVersion=function(a,b){return interop.invoke(this.instanceId,
{method:"getVersion",fileName:a,defaultValue:b})};a.prototype.reboot=function(){return interop.invoke(this.instanceId,{method:"reboot"})};a.prototype.findWindow=function(a,b,e){return interop.invoke(this.instanceId,{method:"findWindow",caption:a,className:b,searchOnlyVisible:e})};a.prototype.getFreeDiskSpace=function(a){return interop.invoke(this.instanceId,{method:"getFreeDiskSpace",path:a})};a.prototype.createShortcut=function(a,b,e,f,g){return interop.invoke(this.instanceId,{method:"createShortcut",
executable:a,parameter:b,iconId:e,location:f,description:g})};a.prototype.removeShortcut=function(a,b){return interop.invoke(this.instanceId,{method:"removeShortcut",location:a,description:b})};a.prototype.setRestorePoint=function(a,b){return interop.invoke(this.instanceId,{method:"setRestorePoint",applicationName:a,defaultValue:b})};a.prototype.removeRestorePoint=function(a){return interop.invoke(this.instanceId,{method:"removeRestorePoint",restorePointID:a})};a.prototype.fileCopy=function(a,b){return interop.invoke(this.instanceId,
{method:"fileCopy",sourceFilename:a,targetFilename:b})};a.prototype.isProcessRunning=function(a){return interop.invoke(this.instanceId,{method:"isProcessRunning",filename:a})};a.prototype.authenticateCertificate=function(a,b){return interop.invoke(this.instanceId,{method:"authenticateCertificate",filename:a,commonName:b})};a.prototype.resetSystemIdleTimer=function(){return interop.invoke(this.instanceId,{method:"resetSystemIdleTimer"})};window.platform=interop.createInstance("SSN.Platform",a);b=notificationCenter.addObserver("Host",
"DidUnload",function(){b.release();window.platform.release();window.platform=null})})();
function StatusView(a){var b=this;this.instanceId=app.expandString("{Guid}");this.progressBarElementClass=this.progressBarElement=this.progressElement=this.statusElement=this.titleElement=this.iconElement=this.rootElement=null;this.silent=false;this.controller=a.controller;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","Complete",a,function(c,d){b.onComplete(a,
d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","UpdateView",a,function(c,d){b.onUpdateView(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Workflow","WillUnload",workflow,function(c,d){b.onWorkflowUnload(a,d)}))}
StatusView.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.progressBarElementClass)){this.progressBarElementClass.release();this.progressBarElementClass=null}if(!isNull(this.controller)){this.controller.release();this.controller=null}};StatusView.prototype.onWorkflowUnload=function(){this.release()};
StatusView.prototype.onStart=function(a){notificationCenter.fire("StatusView","Bind",a,this);if(hasOwnProperty(a.args,"enableView"))this.silent=a.args.enableView===false;if(hasOwnProperty(a.args,"icon"))this.onUpdateImage(this.iconElement,a.getStringArgument("icon"));if(hasOwnProperty(a.args,"title"))this.onUpdateElement(this.titleElement,host.getLanguageString(a.getStringArgument("title")));if(!isNull(this.progressBarElement))this.progressBarElementClass=new ChangeClass(this.progressBarElement)};
StatusView.prototype.onComplete=function(a){if(a.hasError())this.onUpdateElement(this.statusElement,host.getLanguageString(a.getFirstErrorMessage()));else if(a.hasWarning())this.onUpdateElement(this.statusElement,host.getLanguageString(a.getFirstWarningMessage()))};StatusView.prototype.onUpdateVisibility=function(a,b){if(!this.silent&&!isNull(a)){var c=a.is(":visible");if(c!==b){a.toggle();a.trigger("changed",[c,b])}}};
StatusView.prototype.onUpdateElement=function(a,b){if(!this.silent&&!isNull(a)){var c=a.html();if(c!==b){a.html(b);a.trigger("changed",[c,b])}}};StatusView.prototype.onUpdateImage=function(a,b){if(!this.silent&&!isNull(a)){var c=a.attr("src");if(c!==b){a.attr("src",b);a.trigger("changed",[c,b])}}};StatusView.prototype.onUpdateCheckbox=function(a,b){if(!this.silent&&!isNull(a)){var c=a.attr("checked");if(c!==b){a.attr("checked",b);a.trigger("changed",[c,b])}}};
StatusView.prototype.onUpdateStatus=function(a){this.onUpdateElement(this.statusElement,host.getLanguageString(a))};
StatusView.prototype.onUpdateProgress=function(a){a={percent:parseInt(a*100,10)};notificationCenter.fire("TaskView","WillUpdateProgress",this,a);if(this.silent!==true&&(!isNull(this.progressElement)||!isNull(this.progressBarElement))&&a.percent!==this.lastPercent){this.lastPercent=a.percent;this.onUpdateElement(this.progressElement,Math.max(a.percent,0)+"%");if(!isNull(this.progressBarElement)){if(a.percent<0){this.progressBarElement.width("100%");this.progressBarElementClass.apply("indefinite")}else{this.progressBarElementClass.apply(null);
host.isIE6===true?this.progressBarElement.width(Math.max(a.percent,1)+"%"):this.progressBarElement.width(a.percent+"%")}this.progressBarElement.trigger("updateProgress",a.percent)}}};StatusView.prototype.onUpdateView=function(a,b){var c=this;$.each(b,function(a,b){switch(a){case "status":c.onUpdateElement(c.statusElement,host.getLanguageString(b));break;case "progress":c.onUpdateProgress(b)}})};
function AggregateController(a,b){var c=this;this.observers=[];this.xhr=this.actions=null;this.queueController=new QueueController(a,b);this.queueController.onStart=function(){};this.queueController.onRunSubTask=function(b,e,f){a.runSubTask(c.actions[c.queueController.currentActionIndex].name,c.actions[c.queueController.currentActionIndex].value,function(){f()})};this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(b,e){c.onStart(a,e)}))}
AggregateController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.xhr)){this.xhr.abort();this.xhr=null}if(!isNull(this.queueController)){this.queueController.release();this.queueController=null}this.actions=null};
AggregateController.prototype.onStart=function(a){var b=this;if(hasOwnProperty(a.args,"url"))this.xhr=$.getJSON(app.expandString(a.args.url),function(c){b.onAggregateContent(a,c)}).error(function(){a.error("Aggregate_RequestFail");a.complete()});else if(hasOwnProperty(a.args,"content"))if(getObjectType(a.args.content.format)==="function")this.onAggregateContent(a,interop.parseJSON(app.expandString(a.args.content)));else this.onAggregateContent(a,a.args.content);else host.assert(false,"{0} not defined for ({1}) in ({2})".format("url/content",
a.type,a.name))};AggregateController.prototype.onAggregateContent=function(a,b){var c=this;c.actions=[];getObjectType(b.forEach)==="function"?b.forEach(function(b){c.addTasks(a,b)}):c.addTasks(a,b);this.queueController.totalActions=this.actions.length;this.queueController.onQueueStart(a,{})};
AggregateController.prototype.addTasks=function(a,b){var c=this;getObjectProperties(b).forEach(function(a){var e=b[a];getObjectType(e)==="array"?e.forEach(function(b){c.actions.push({name:a,value:b})}):c.actions.push({name:a,value:e})})};registerTaskController("aggregate",AggregateController);function AppExt(a){this.instanceId=a}AppExt.prototype.release=function(){interop.releaseInstance(this.instanceId)};AppExt.prototype.getFilename=function(){return interop.invoke(this.instanceId,{method:"getFilename"})};
AppExt.prototype.setFilename=function(a){return interop.invoke(this.instanceId,{method:"setFilename",value:a})};AppExt.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};function createAppExt(){return interop.createInstance("SSN.AppExt",AppExt)}function AppNotificationDock(){this.LEFT=1;this.RIGHT=2;this.TOP=4;this.BOTTOM=8}
AppNotificationDock.prototype.nameFromId=function(a){var b=[];a==this.LEFT&&b.push("Left");(a&this.RIGHT)==this.RIGHT&&b.push("Right");(a&this.TOP)==this.TOP&&b.push("Middle");(a&this.BOTTOM)==this.BOTTOM&&b.push("Bottom");return b.join(", ")};var appNotificationDock=new AppNotificationDock;function BrowserController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}
BrowserController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};BrowserController.prototype.onHostIsBrowser=function(a){app.expandString("{PluginVersion}")!=="{PluginVersion}"?a.runSubAction("browser",null,function(){a.complete()}):a.runSubAction("local",null,function(){a.complete()})};BrowserController.prototype.onBrowserNotify=function(a){a.assertArgument("content");app.remoteNotify(JSON.stringify(a.args.content));a.complete()};
BrowserController.prototype.onBrowserCheckUrl=function(a){var b=app.expandString("{WindowLocationUrl}"),c;a.debugPrint("Checking browser url {0}\n".format(b));if(hasOwnProperty(a.args,"url")){c=a.getStringArgument("url");if(b.toLowerCase().beginsWith(c.toLowerCase())===false){a.debugPrint("Browser control does not match url ({0}) ({1})\n".format(b,c));a.error("Browser_UnauthorizedUrl")}}else if(app.authorizeUrl(b)===false){a.debugPrint("Browser control not in hostname whitelist ({0}) ({1})\n".format(b));
a.error("Browser_UnauthorizedUrl")}a.complete()};BrowserController.prototype.onBrowserCheckIFrame=function(a){var b=app.expandString("{TopWindowLocationUrl}"),c=app.expandString("{WindowLocationUrl}");if(b!==c){a.debugPrint("Unable to load browser control in iframe ({0}) ({1})\n".format(b,c));a.error("Browser_IFrameFound")}a.complete()};
BrowserController.prototype.onStart=function(a){switch(a.args.type){case "hostIsBrowser":this.onHostIsBrowser(a);break;case "browserNotify":this.onBrowserNotify(a);break;case "browserCheckUrl":this.onBrowserCheckUrl(a);break;case "browserCheckIFrame":this.onBrowserCheckIFrame(a);break;default:host.assert(false,"Unknown type in BrowserController ({0})".format(a.args.type))}};registerTaskController("hostIsBrowser",BrowserController);registerTaskController("browserNotify",BrowserController);
registerTaskController("browserCheckUrl",BrowserController);registerTaskController("browserCheckIFrame",BrowserController);var BrowserUninstallState={Unregister:1,Erase:2,Finalize:3,Shutdown:4};
function BrowserUninstallController(a){var b=this;this.process=createProcess();this.nextTimer=null;this.state=0;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Process","Complete",this.process,function(c,d){b.onFileUnregisterComplete(a,d)}))}
BrowserUninstallController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.nextTimer)){clearTimeout(this.nextTimer);this.nextTimer=null}if(!isNull(this.process)){this.process.release();this.process=null}};BrowserUninstallController.prototype.setState=function(a){this.state=a;this.currentIndex=0};
BrowserUninstallController.prototype.next=function(a,b){if(b===true)this.currentIndex=this.currentIndex+1;switch(this.state){case BrowserUninstallState.Unregister:if(this.currentIndex>=this.unregisterFiles.length){this.setState(BrowserUninstallState.Erase);this.nextAfter(a,0,false)}else this.onFileUnregister(a,{index:this.currentIndex});break;case BrowserUninstallState.Erase:if(this.currentIndex>=this.eraseFiles.length){this.setState(BrowserUninstallState.Finalize);this.nextAfter(a,0,false)}else this.onFileErase(a,
{index:this.currentIndex});break;case BrowserUninstallState.Finalize:app.setRemoveLocalStorage(true);app.implode();platform.collapseEmptyDirectories(this.rootDirectory);a.complete();this.setState(BrowserUninstallState.Shutdown);this.nextAfter(a,100,true);break;case BrowserUninstallState.Shutdown:app.closeAll();break;default:a.error("Uninstall_UnknownState");a.complete()}};
BrowserUninstallController.prototype.nextAfter=function(a,b,c){var d=this;host.assert(isNull(this.nextTimer),"Already processing uinstall timer");this.nextTimer=setTimeout(function(){d.nextTimer=null;d.next(a,c)},b)};BrowserUninstallController.prototype.onFileError=function(a){a.error("OSError_"+osError.nameFromId(this.versionUninstall.getLastFileError()));a.complete()};
BrowserUninstallController.prototype.onFileLocked=function(a){notificationCenter.fire("Task","UpdateView",a,{status:"Uninstall_Locked"});this.nextAfter(a,1E3,false)};
BrowserUninstallController.prototype.onFileErase=function(a){var b=0;if(this.currentIndex>=this.eraseFiles.length){this.currentIndex=0;this.onDirectoryCollapse()}else{b=platform.fileErase(this.eraseFiles[this.currentIndex]);if(b!=osError.ERROR_SUCCESS){if(host.isWin===true)switch(b){case osError.ERROR_ACCESS_DENIED:case osError.ERROR_SHARING_VIOLATION:case osError.ERROR_LOCK_VIOLATION:return this.onFileLocked(a,{lastError:b})}return this.onFileError(a,{lastError:b})}notificationCenter.fire("Task",
"UpdateView",a,{status:"Uninstall_Running"});this.nextAfter(a,0,true)}};BrowserUninstallController.prototype.onFileUnregisterComplete=function(a,b){if(b.exitCode!==0){a.error("Uninstall_UnregisterFail");a.complete()}else this.nextAfter(a,0,true)};
BrowserUninstallController.prototype.onFileUnregister=function(a,b){if(platform.fileExists(this.unregisterFiles[b.index])===false)this.nextAfter(a,0,true);else{this.process.setApplicationName(app.expandString("{SystemPath}regsvr32.exe"));this.process.setElevationRights(processElevationRights.ELEVATED);this.process.setArguments(app.expandString('/s /u "{0}"'.format(this.unregisterFiles[b.index])));a.debugPrint("command = {0}\n".format(this.process.getApplicationName()));a.debugPrint("args = {0}\n".format(this.process.getArguments()));
this.process.launch()}};
BrowserUninstallController.prototype.onStart=function(a){a.assertArgument("unregister");a.assertArgument("metafile");a.assertArgument("targetDirectory");this.eraseFiles=[app.expandString("{ModulePath}"+a.getStringArgument("unregister")),app.expandString("{ModulePath}..{PathSeparator}"+a.getStringArgument("metafile"))];this.unregisterFiles=[app.expandString("{ModulePath}"+a.getStringArgument("unregister"))];this.rootDirectory=a.getStringArgument("targetDirectory");if(host.isRemote===true){app.remoteDetach();
skinWindow.center();skinWindow.show()}if(app.getElevated()){notificationCenter.fire("Task","UpdateView",a,{status:"Uninstall_Running"});this.setState(BrowserUninstallState.Unregister);this.next(a,false)}else{app.setRestartElevated(true);app.setRestart(true);a.error("Uninstall_RequiresElevated");a.complete()}};registerTaskController("browserUninstall",BrowserUninstallController);registerTaskView("browserUninstall",StatusView);
function BrowserUpdateController(a,b){var c=this;if(!hasOwnProperty(a.args,"config"))a.args.config={};this.httpRequest=createHttpRequest();this.httpRequest.setCleanup(true);this.httpRequest.setUseCache(true);this.httpRequest.setType(httpRequestType.GET);this.process=createProcess();this.lockTimer=null;this.systemMutex=createSystemMutex();this.downloadController=new DownloadController(a,b);this.downloadController.onStartOriginal=this.downloadController.onStart;this.downloadController.onStart=function(a,
b){c.onStart(a,b)};this.downloadController.onDownloadCompleteOriginal=this.downloadController.onDownloadComplete;this.downloadController.onDownloadComplete=function(a,b){c.onDownloadComplete(a,b)};this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("HttpRequest","Complete",this.httpRequest,function(b,e){c.onMetafileDownloadComplete(a,e)}))}
BrowserUpdateController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.lockTimer)){clearInterval(self.lockTimer);this.lockTimer=null}if(!isNull(this.systemMutex)){this.systemMutex.unlock();this.systemMutex.release();this.systemMutex=null}if(!isNull(this.httpRequest)){this.httpRequest.release();this.httpRequest=null}if(!isNull(this.process)){this.process.release();this.process=null}if(!isNull(this.downloadController)){this.downloadController.release();
this.downloadController=null}};
BrowserUpdateController.prototype.onStart=function(a,b){var c=this,d,e;a.assertArgument("url");a.assertArgument("targetDirectory");if(hasOwnProperty(a.args,"requiresElevated")&&a.args.requiresElevated&&!app.getElevated())this.onRestart(a);else{e=a.getStringArgument("url");d=e.substring(e.lastIndexOf("/")+1).toLowerCase();a.args.config.outputPath=app.expandString("{0}{Guid}{PathSeparator}".format(a.getStringArgument("targetDirectory")));this.httpRequest.setCleanup(false);this.httpRequest.setFileName(app.expandString("{0}{1}".format(a.args.targetDirectory,
d)));this.systemMutex.setName(app.expandString("{MD5:{0}}".format(e.toLowerCase())));notificationCenter.fire("Task","UpdateView",a,{state:browserUpdateState.METAFILE,status:"Update_Checking"});c.lockTimer=setInterval(function(){if(c.systemMutex.lockWithTimeout(0)){c.onStartLocked(a,b);clearInterval(c.lockTimer);c.lockTimer=null}},250)}};BrowserUpdateController.prototype.onStartLocked=function(a){this.httpRequest.setUrl(a.getStringArgument("url"));this.httpRequest.start()};
BrowserUpdateController.prototype.onMetafileDownloadComplete=function(a,b){if(b.httpCode===304)this.onComplete(a,false);else if(b.httpCode!==200){a.error("Update_MetafileNotFound");this.onComplete(a,false)}else{a.args.metafile=this.httpRequest.getFileName();notificationCenter.fire("Task","UpdateView",a,{state:browserUpdateState.DOWNLOAD,progress:0});this.downloadController.onStartOriginal(a,b)}};BrowserUpdateController.prototype.onRegisterMac=function(){host.assert(false,"Not implemented")};
BrowserUpdateController.prototype.onRegisterWin=function(a){var b=this;this.process.setApplicationName(app.expandString("{SystemPath}regsvr32.exe"));this.process.setElevationRights(processElevationRights.ELEVATED);this.process.setArguments(app.expandString('/s "{0}{1}"'.format(a.args.config.outputPath,a.args.register)));this.observers.push(notificationCenter.addInstanceObserver("Process","Complete",this.process,function(c,d){a.debugPrint("exit code {0}\n".format(d.exitCode));if(d.exitCode!==0){a.error("Update_RegisterFail");
b.onComplete(a,false)}else b.onComplete(a,true)}));a.debugPrint("command {0}\n".format(this.process.getApplicationName()));a.debugPrint("args {0}\n".format(this.process.getArguments()));this.process.launch()};BrowserUpdateController.prototype.onRegister=function(a){if(hasOwnProperty(a.args,"register"))if(host.isWin===true)this.onRegisterWin(a);else{if(host.isMac===true)this.onRegisterMac(a)}else this.onComplete(a,true)};
BrowserUpdateController.prototype.onDownloadComplete=function(a,b){if(b.successful)this.onRegister(a);else{a.error("DownloadError_"+downloadError.nameFromId(this.getDownload().getLastError()));this.onComplete(a,false)}};
BrowserUpdateController.prototype.onUpdateComplete=function(a){platform.directoryExists(this.getDownload().getOptionString("OutputPath"))&&platform.directoryErase(this.getDownload().getOptionString("OutputPath"));if(hasOwnProperty(a.args,"restart")&&a.args.restart===true)this.onRestart(a);else this.onComplete(a,true)};BrowserUpdateController.prototype.onRestart=function(a){this.systemMutex.unlock();a.args.requiresElevated===true&&app.setRestartElevated(true);app.setRestart(true)};
BrowserUpdateController.prototype.onComplete=function(a,b){function c(){a.complete()}this.systemMutex.unlock();notificationCenter.fire("Task","UpdateView",a,{state:browserUpdateState.COMPLETE});a.hasError()?this.httpRequest.setCleanup(true):notificationCenter.fire("Task","UpdateView",a,{progress:1,status:"Update_Complete"});b?a.runSubAction("updated",null,c):a.hasError()?a.runSubAction("notUpdated",null,c):a.runSubAction("updateFailed",null,c)};BrowserUpdateController.prototype.getDownload=function(){return this.downloadController.getDownload()};
registerTaskController("browserUpdate",BrowserUpdateController);function BrowserUpdateState(){this.UNKNOWN=-1;this.IDLE=0;this.METAFILE=1;this.DOWNLOAD=2;this.COMPLETE=3}BrowserUpdateState.prototype.nameFromId=function(a){return a<0?"Unknown":["Idle","Metafile","Download","Complete"][a]};var browserUpdateState=new BrowserUpdateState;
function BrowserUpdateView(a,b){var c=this;this.instanceId=app.expandString("{Guid}");this.statusElement=this.rootElementClass=this.rootElement=null;this.updateState=browserUpdateState.IDLE;this.downloadView=new DownloadView(a,b);this.downloadView.onUpdateProgressOriginal=this.downloadView.onUpdateProgress;this.downloadView.onUpdateProgress=function(a){c.onUpdateProgressInternal(a)};this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(b,e){c.onStart(a,
e)}));this.observers.push(notificationCenter.addInstanceObserver("Task","Complete",a,function(b,e){c.onComplete(a,e)}));this.observers.push(notificationCenter.addInstanceObserver("Task","UpdateView",a,function(b,e){c.onUpdateView(a,e)}));this.observers.push(notificationCenter.addInstanceObserver("TaskView","WillUpdateProgress",this.downloadView,function(b,e){c.onDownloadViewWillUpdateProgress(a,e)}));this.observers.push(notificationCenter.addInstanceObserver("Workflow","WillUnload",workflow,function(b,
e){c.onWorkflowUnload(a,e)}))}BrowserUpdateView.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.rootElementClass)){this.rootElementClass.release();this.rootElementClass=null}if(!isNull(this.downloadView)){this.downloadView.release();this.downloadView=null}};BrowserUpdateView.prototype.onWorkflowUnload=function(){this.release()};
BrowserUpdateView.prototype.onStart=function(a){notificationCenter.fire("BrowserUpdateView","Bind",a,this);if(!isNull(this.rootElement))this.rootElementClass=new ChangeClass(this.rootElement)};BrowserUpdateView.prototype.onComplete=function(a){isNull(this.rootElement)||(a.hasError()?a.hasWarning()&&this.rootElementClass.apply("updateStateWarning"):this.rootElementClass.apply("updateStateComplete"))};
BrowserUpdateView.prototype.onUpdateProgressInternal=function(a){var b=0,c=0,d=[0,0.5,0.5];if(a>-1){for(c=0;c<d.length;c=c+1){if(c===this.updateState)break;b=b+d[c]}b=b+d[c]*parseFloat(a)}this.downloadView.onUpdateProgressOriginal(b)};BrowserUpdateView.prototype.onUpdateView=function(a,b){var c=this;$.each(b,function(a,b){switch(a){case "status":c.downloadView.onUpdateElement(c.statusElement,host.getLanguageString(b));break;case "state":c.updateState=b;break;case "progress":c.onUpdateProgressInternal(b)}})};
BrowserUpdateView.prototype.onDownloadViewWillUpdateProgress=function(a,b){notificationCenter.fire("TaskView","WillUpdateProgress",this,b)};registerTaskView("browserupdate",BrowserUpdateView);function ChangeClass(a){this.element=a}ChangeClass.prototype.release=function(){this.apply(null)};
ChangeClass.prototype.apply=function(a){if((!isNull(a)||!isNull(this.currentState))&&a!==this.currentState){var b=null;if(!isNull(this.currentState))b=this.currentState;if(host.isIE6===true){var c=this.element.attr("class");isNull(c)&&(c="");isNull(a)&&(a="");c=!isNull(this.currentState)&&this.currentState.length>0?c.replace(this.currentState,a):c.length===0?c+a:c+("-"+a);c=c.replace(/-{2,}/g,"-");c=c.replace(/-$/,"");c=c.replace(/^-+/g,"");this.element.attr("class",c);this.currentState=a}else{isNull(this.currentState)||
this.element.removeClass(this.currentState);this.currentState=a;isNull(a)||this.element.addClass(this.currentState)}this.element.trigger("cssClassChanged",[b,this.currentState])}};
function DebugFlag(){this.DISABLED=0;this.WINDOW=1;this.FILE=2;this.VERBOSE=4;this.APPEND=8;this.COMMANDLINE=16;this.TIMESTAMP=32;this.UNIQUE=64;this.LOGERRORS=128;this.PERTHREAD=256;this.PERPROCESS=512;this.MEMORYREPORTING=1024;this.EXTERNALPRINT=2048;this.SILENCEBELL=4096;this.ABORTDEBUGGER=8192;this.MEMORYTESTING=16384;this.MUTEXREPORTING=32768;this.COMMIT=65536;this.MEMORYTRACKING=131072}var debugFlag=new DebugFlag;
$(document).ready(function(){var a=null;window.debugOptionsView=new function(){this.instanceId=app.expandString("{Guid}");this.fileElement=this.consoleElement=this.rootElement=null};notificationCenter.fire("DebugOptionsView","Bind",window.debugOptionsView,window.debugOptionsView);if(isNull(window.debugOptionsView.rootElement)&&isNull(window.debugOptionsView.consoleElement)&&isNull(window.debugOptionsView.fileElement))window.debugOptionsView=null;else{notificationCenter.addInstanceObserver("SkinWindow",
"DidClose",skinWindow,function(){isNull(window.debugOptionsView.consoleElement)||window.debugOptionsView.consoleElement.unbind();isNull(window.debugOptionsView.fileElement)||window.debugOptionsView.fileElement.unbind();window.debugOptionsView=null});if(!isNull(window.debugOptionsView.rootElement)){a=new ChangeClass(window.debugOptionsView.rootElement);isNull(window.debugOptionsView.consoleElement)||window.debugOptionsView.consoleElement.change(function(){a.apply("optionChanged")});isNull(window.debugOptionsView.fileElement)||
window.debugOptionsView.fileElement.change(function(){a.apply("optionChanged")});window.debugOptionsView.rootElement.find("form").submit(function(){var b=app.getDebugFlags()|debugFlag.VERBOSE|debugFlag.TIMESTAMP,c=b,d=app.getDebugFilename();a.apply(null);if(!isNull(window.debugOptionsView.fileElement))if(window.debugOptionsView.fileElement.prop("checked")){d=app.expandString("{LocalStorage}{ModuleFileTitle}.log");c=c|debugFlag.FILE}else c=c&~debugFlag.FILE;isNull(window.debugOptionsView.consoleElement)||
(c=window.debugOptionsView.consoleElement.prop("checked")?c|debugFlag.WINDOW:c&~debugFlag.WINDOW);b!=c&&app.setDebugLogging(d,c);return false})}isNull(window.debugOptionsView.fileElement)||window.debugOptionsView.fileElement.prop("checked",(app.getDebugFlags()&debugFlag.FILE)==debugFlag.FILE);isNull(window.debugOptionsView.consoleElement)||window.debugOptionsView.consoleElement.prop("checked",(app.getDebugFlags()&debugFlag.WINDOW)==debugFlag.WINDOW)}});
function DmgController(a){var b=this;this.observers=[];this.mountPoint=this.filename="";this.mountExitCode=-1;this.output="";this.action="attach";this.pipe=this.process=null;this.elevationRights=processElevationRights.INVOKER;this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}
DmgController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.process)){this.process.release();this.process=null}if(!isNull(this.pipe)){this.pipe.release();this.pipe=null}};
DmgController.prototype.reset=function(a){var b=this;if(!isNull(this.process)){this.process.release();this.process=null}if(!isNull(this.pipe)){this.pipe.release();this.pipe=null}this.process=createProcess();this.pipe=createPipe();this.output="";this.mountExitCode=-1;this.observers.push(notificationCenter.addInstanceObserver("Process","Complete",this.process,function(c,d){b.onProcessComplete(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Pipe","Read",this.pipe,function(c,d){b.onPipeRead(a,
d)}))};
DmgController.prototype.onStart=function(a,b){a.assertArgument("filename");switch(a.args.type.toLowerCase()){case "mountdmg":this.action="attach";notificationCenter.fire("Task","UpdateView",a,{status:"DiskImage_Mounting"});break;case "unmountdmg":this.action="eject"}this.filename=a.getStringArgument("filename");this.mountPoint=hasOwnProperty(a.args,"target")?"/Volumes/{0}/".format(a.args.target):"/Volumes/{0}/".format(app.expandString("{SHA1:"+this.filename.toLowerCase()+"}"));if(hasOwnProperty(a.args,"elevationRights"))switch(a.args.elevationRights.toLowerCase()){case "user":this.elevationRights=
processElevationRights.USER;break;case "elevated":this.elevationRights=processElevationRights.ELEVATED;break;case "asinvoker":this.elevationRights=processElevationRights.INVOKER}this.runMountUtil(a,b)};DmgController.prototype.setError=function(a,b,c,d){hasOwnProperty(a.args,"errorMap")&&hasOwnProperty(a.args.errorMap,c)?a.error(a.args.errorMap[c]):a.error(d)};
DmgController.prototype.runMountUtil=function(a,b,c){if(typeof c!=="undefined")this.action=c;c=this.action=="attach"?"{0} '{1}' -mountpoint '{2}' -nobrowse".format(this.action,this.filename,this.mountPoint):"{0} '{1}' -force".format(this.action,this.mountPoint);this.reset(a,b);this.pipe.setBufferSize(1024);this.pipe.setName(app.expandString("{GUID}"));this.pipe.setOpenExisting(false);this.pipe.start();a.debugPrint("hdiutil mounting {0}\n".format(this.mountPoint));a.debugPrint("hdiutil args {0}\n".format(c));
this.process.setApplicationName("/bin/sh");this.process.setArguments(app.expandString('-c "/usr/bin/hdiutil '+c+" &> {PipePath}"+this.pipe.getName()+";echo **EOP**$? > {PipePath}"+this.pipe.getName()+'"'));this.process.setShowWindow(false);this.process.setElevationRights(this.elevationRights);this.process.launch()};
DmgController.prototype.onPipeRead=function(a,b){var c=this,d=-1;this.output=this.output+app.base64Decode(b.buffer);d=this.output.indexOf("**EOP**");if(d!=-1){this.mountExitCode=parseInt(this.output.substring(d+7));this.output=this.output.substring(0,d);a.debugPrint("hdiutil mount exitcode {0}\n".format(this.mountExitCode));if(this.action=="attach"){if(this.mountExitCode!=0){a.debugPrint("hdiutil output {0}\n".format(this.output));this.setError(a,b,this.mountExitCode,"DiskImage_MountFailure")}if(isNull(a.args.mounted))this.onComplete(a,
b);else a.runSubAction("mounted",null,function(){c.runMountUtil(a,b,"eject")})}else this.onComplete(a,b)}};DmgController.prototype.onProcessComplete=function(a,b){a.debugPrint("hdiutil exitcode {0} complete {1}\n".format(b.exitCode,b.successful));(b.successful===false||b.exitCode!=0)&&this.setError(a,b,b.exitCode,"DiskImage_LaunchFailure")};DmgController.prototype.onComplete=function(a,b){a.complete(b)};registerTaskController("mountDmg",DmgController);registerTaskController("unmountDmg",DmgController);
registerTaskView("mountDmg",StatusView);registerTaskView("unmountDmg",StatusView);function FileSystemController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}FileSystemController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};FileSystemController.prototype.translateError=function(a,b){b!==0&&a.error("OSError_"+osError.nameFromId(b))};
FileSystemController.prototype.onFileErase=function(a){var b=this;a.assertArgument("filename");getObjectType(a.args.filename.forEach)==="function"?a.args.filename.forEach(function(c){b.translateError(a,platform.fileErase(app.expandString(c)))}):this.translateError(a,platform.fileErase(app.expandString(a.args.filename)));a.complete()};
FileSystemController.prototype.onFileCopy=function(a){var b=this;a.assertArgument("filelist");var c=a.args.filelist;if(getObjectType(c.forEach)==="function")c.forEach(function(c){var d=c.indexOf("->");d>0?b.translateError(a,platform.fileCopy(app.expandString(c.substr(0,d)),app.expandString(c.substr(d+2)))):a.error("OSError_None")});else{var d=c.indexOf("->");d>0?b.translateError(a,platform.fileCopy(app.expandString(c.substr(0,d)),app.expandString(c.substr(d+2)))):a.error("OSError_None")}a.complete()};
FileSystemController.prototype.onDirectoryErase=function(a){var b=this;a.assertArgument("directory");if(getObjectType(a.args.directory.forEach)==="function")a.args.directory.forEach(function(c){(c=app.expandString(c))?b.translateError(a,platform.directoryErase(c)):a.error("OSError_None")});else{var c=app.expandString(a.args.directory);c?this.translateError(a,platform.directoryErase(c)):a.error("OSError_None")}a.complete()};
FileSystemController.prototype.onDirectoryCreate=function(a){var b=this;a.assertArgument("directory");getObjectType(a.args.directory.forEach)==="function"?a.args.directory.forEach(function(c){window.platform.directoryExists(app.expandString(c))||b.translateError(a,platform.directoryCreate(app.expandString(c)))}):window.platform.directoryExists(app.expandString(a.args.directory))||this.translateError(a,platform.directoryCreate(app.expandString(a.args.directory)));a.complete()};
FileSystemController.prototype.onFileExists=function(a){a.assertArgument("filename");var b=true;getObjectType(a.args.filename.forEach)==="function"?a.args.filename.forEach(function(a){b=b&&window.platform.fileExists(app.expandString(a))}):b=window.platform.fileExists(app.expandString(a.args.filename));b?a.runSubAction("exists",null,function(){a.complete()}):a.runSubAction("missing",null,function(){a.complete()})};
FileSystemController.prototype.onDirectoryExists=function(a){a.assertArgument("directory");window.platform.directoryExists(app.expandString(a.args.directory))?a.runSubAction("exists",null,function(){a.complete()}):a.runSubAction("missing",null,function(){a.complete()})};
FileSystemController.prototype.onStart=function(a,b){switch(a.args.type){case "deleteFile":this.onFileErase(a,b);break;case "copyFile":this.onFileCopy(a,b);break;case "deleteDirectory":this.onDirectoryErase(a,b);break;case "createDirectory":this.onDirectoryCreate(a,b);break;case "checkFileExists":this.onFileExists(a,b);break;case "checkDirectoryExists":this.onDirectoryExists(a,b);break;default:host.assert(false,"Unknown type in FileSystemController ({0})".format(a.args.type))}};
registerTaskController("copyFile",FileSystemController);registerTaskController("deleteFile",FileSystemController);registerTaskController("deleteDirectory",FileSystemController);registerTaskController("createDirectory",FileSystemController);registerTaskController("checkFileExists",FileSystemController);registerTaskController("checkDirectoryExists",FileSystemController);
(function(){function a(){this.enableDebugging=app.getSecurityEnabled()===false&&app.isCommandFieldSet("debugscript");this.isMac=this.isWin=false;this.isCEF=app.expandString("{Host}").toLowerCase()==="cef";this.isIE6=app.expandString("{Host}{HostMajorVersion}").toLowerCase()==="ie6";this.isRemote=app.isCommandFieldSet("remoteserver");this.instanceId="Host";if(app.getSecurityEnabled()===false&&app.isCommandFieldSet("ie6class"))this.isIE6=true;switch(app.expandString("{systemshortname}")){case "win":this.isWin=
true;break;case "mac":this.isMac=true}}a.prototype.elevate=function(){if(app.getElevated()===false){app.setRestartElevated(true);app.setRestart(true);return true}return false};a.prototype.idFromString=function(a){return app.expandString("{SHA1:{Lower:"+a+"}}")};a.prototype.urlToFileName=function(a,c,d){a=a.replace(app.expandString("{ContentUrl}"),app.expandString("{ModuleFileName}\\"));return a=app.expandString(c+"{SHA1:"+a.toLowerCase()+"}"+d)};a.prototype.extractJSON=function(a,c){this.extractContent(a,
function(a){if(a.successful===false)c(null);else{a=interop.parseJSON(a.content);c(a)}})};a.prototype.extractContent=function(a,c){var d=createSkinFileExtract(),e=[];d.setFilename(a);e.push(notificationCenter.addInstanceObserver("SkinFileExtract","Complete",d,function(a,b){var h=0,i,j=null;e.forEach(function(a){a.release()});e=[];if(b.successful===true){j="";do{i=app.base64Decode(d.getBuffer(h,4E3));j=j+i;h=h+4E3}while(i.length>0);i=null}c!==null&&c({successful:b.successful,content:j});j=null;d.release()}));
d.start()};a.prototype.getLanguageString=function(a){return isNull(Language)||hasOwnProperty(Language,a)===false?a:app.expandString(Language[a])};a.prototype.loadLanguageByCode=function(a,c,d){var e=a.toLowerCase(),f=c.toLowerCase();window.Language={};host.extractJSON("locale.json",function(a){var b="{0}-{1}".format(e,f),b=["us","en","en-us",e,f,b];if(isNull(a))isNull(d)||d({successful:false});else{b.forEach(function(b){if(hasOwnProperty(a,b)){app.debugPrint("Loading localization ({0})\n".format(b));
mergeObjectProperties(window.Language,a[b],true)}});d({successful:true})}})};a.prototype.openWindow=function(a){var c="",d=null,c=app.openWindow(app.expandString(a));c.length>0&&(d=window.attachSkinWindow(c));return d};a.prototype.assert=function(a,c){if(!a){app.debugPrint(c+"\n");!isNull(window.console)&&!isNull(window.console.error)&&console.error(c);this.debugBreak()}};a.prototype.debugBreak=function(){if(this.enableDebugging===true)debugger};window.host=new a})();
(function(){var a,b,c,d;window.Language=null;d=a=false;$(document).ready(function(){var a="";$(document).mousemove(function(b){if(!isNull(window.skinWindow)){b=$(b.target).css("cursor");if(a!==b){window.skinWindow.setCursor(b);a=b}}})});b=function(){notificationCenter.addInstanceObserver("SkinWindow","DidClose",window.skinWindow,function(){notificationCenter.fire("Host","DidUnload",host,{})});notificationCenter.fire("Host","DidLoad",host,{});a=true};c=function(){if(a!==true){try{document.documentElement.doScroll("left")}catch(d){setTimeout(c,
1);return}b()}};if(document.addEventListener)window.addEventListener("load",b,false);else if(document.attachEvent){window.attachEvent("onload",b);try{d=window.frameElement===null}catch(e){}document.documentElement.doScroll&&d&&c()}})();function HostController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}
HostController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
HostController.prototype.onShutdown=function(a){function b(){hasOwnProperty(a.args,"implode")&&a.args.implode===true&&app.implode();if(hasOwnProperty(a.args,"restartElevated")&&a.args.restartElevated===true){app.setRestartElevated(true);app.setRestart(true)}else hasOwnProperty(a.args,"restart")&&a.args.restart===true?app.setRestart(true):app.closeAll()}hasOwnProperty(a.args,"error")&&a.error(a.args.error);a.complete();hasOwnProperty(a.args,"delay")?setTimeout(b,a.args.delay):b()};
HostController.prototype.onMinimizeWindow=function(a){skinWindow.minimize();a.complete()};HostController.prototype.onRestoreWindow=function(a){skinWindow.restore();a.complete()};HostController.prototype.onIsCommandFieldSet=function(a){function b(){a.complete()}a.assertArgument("name");app.isCommandFieldSet(a.getStringArgument("name"))?a.runSubAction("yes",null,b):a.runSubAction("no",null,b)};
HostController.prototype.onCommandLineCompare=function(a){function b(){a.complete()}a.assertArgument("key");a.assertArgument("value");var c=a.args.key,d=app.expandString(a.args.value),c=app.getCommandFieldByName(c);c.length===0?a.runSubAction("notEqualTo",null,function(){a.runSubAction("missing",null,b)}):c===d?a.runSubAction("equalTo",null,b):c>d?a.runSubAction("notEqualTo",null,function(){a.runSubAction("greaterThan",null,b)}):a.runSubAction("notEqualTo",null,function(){a.runSubAction("lessThan",
null,b)})};
HostController.prototype.onStringCompare=function(a){function b(){a.complete()}a.assertArgument("stringOne");a.assertArgument("stringTwo");var c=a.getStringArgument("stringOne"),d=a.getStringArgument("stringTwo");c===d?a.runSubAction("equalTo",null,b):c.toLowerCase()===d.toLowerCase()?a.runSubAction("equalToIgnoreCase",null,b):c>d?a.runSubAction("notEqualTo",null,function(){a.runSubAction("greaterThan",null,b)}):a.runSubAction("notEqualTo",null,function(){a.runSubAction("lessThan",null,b)})};
HostController.prototype.onPrompt=function(a){a.assertArgument("text");a.assertArgument("caption");a.assertArgument("buttons");var b=a.args.text,c=a.args.caption,d=a.args.buttons,e=0;getObjectType(d)==="string"?d.split("|").forEach(function(a){switch(a.toLowerCase()){case "ok":e=e+skinWindowPrompt.OK;break;case "cancel":e=e+skinWindowPrompt.CANCEL;break;case "yes":e=e+skinWindowPrompt.YES;break;case "no":e=e+skinWindowPrompt.NO}}):e=Number(d);d="";switch(skinWindow.prompt(host.getLanguageString(b),
host.getLanguageString(c),e)){case skinWindowPrompt.OK:d="ok";break;case skinWindowPrompt.CANCEL:d="cancel";break;case skinWindowPrompt.YES:d="yes";break;case skinWindowPrompt.NO:d="no";break;default:a.error("HostError_Unknown")}d&&a.runSubAction(d,null,function(){});a.complete()};
HostController.prototype.onCheckProgramRunning=function(a){a.assertArgument("filename");window.platform.isProcessRunning(app.expandString(a.args.filename))?a.runSubAction("running",null,function(){a.complete()}):a.runSubAction("notrunning",null,function(){a.complete()})};
HostController.prototype.onCheckCertificate=function(a){a.assertArgument("filename");a.assertArgument("commonName");window.platform.authenticateCertificate(app.expandString(a.args.filename),app.expandString(a.args.commonName))?a.runSubAction("passed",null,function(){a.complete()}):a.runSubAction("failed",null,function(){a.complete()})};
HostController.prototype.onStart=function(a,b){switch(a.args.type){case "shutdown":this.onShutdown(a,b);break;case "minimizeWindow":this.onMinimizeWindow(a,b);break;case "restoreWindow":this.onRestoreWindow(a,b);break;case "isCommandFieldSet":this.onIsCommandFieldSet(a,b);break;case "checkCommandLine":this.onCommandLineCompare(a,b);break;case "prompt":this.onPrompt(a,b);break;case "stringCompare":this.onStringCompare(a,b);break;case "checkProgramRunning":this.onCheckProgramRunning(a,b);break;case "checkCertificate":this.onCheckCertificate(a,
b);break;default:host.assert(false,"Unknown type in HostController ({0})".format(a.args.type))}};registerTaskController("shutdown",HostController);registerTaskController("minimizeWindow",HostController);registerTaskController("restoreWindow",HostController);registerTaskController("isCommandFieldSet",HostController);registerTaskController("checkCommandLine",HostController);registerTaskController("prompt",HostController);registerTaskController("stringCompare",HostController);
registerTaskController("checkProgramRunning",HostController);registerTaskController("checkCertificate",HostController);
(function(a){if(app.expandString("{Host}").toLowerCase()==="ie"){a.event.special.mousemove={add:function(b){var c=b.handler,d=0,e=0,f=a(this);b.handler=function(a){if(a.pageX>=0&&a.pageY>=0&&(a.pageX!==d||a.pageY!==e)){d=a.pageX;e=a.pageY;return c.apply(f,[a])}a.preventDefault()}}};a.event.special.mouseenter={add:function(b){var c=b.handler,d=true,e=a(this);a(this).mousemove(function(a){if(d==true){d=false;return c.apply(e,[a])}});a(this).mouseleave(function(){d=true});b.handler=function(a){a.preventDefault()}}};
a.event.special.mouseleave={add:function(b){var c=b.handler,d=-1,e=-1,f=a(this),g=null;b.leaveObs=notificationCenter.addInstanceObserver("SkinWindow","DidMouseLeave",window.skinWindow,function(){if(d>=0&&e>=0){e=d=-1;if(!isNull(g)){g.pageX=-1;g.pageY=-1;c.apply(f,[g]);g=null}}});f.mousemove(function(a){d=a.pageX;e=a.pageY});b.handler=function(a){g=a;if(a.pageX>=0&&a.pageY>=0&&(a.pageX!==d||a.pageY!==e)){g=null;return c.apply(f,[a])}a.preventDefault()}},remove:function(a){a.leaveObs.release();a.leaveObs=
null}};a.event.special.mouseover={add:function(b){var c=b.handler,d=a(this);d.mouseenter(function(a){return c.apply(d,[a])});b.handler=function(a){a.preventDefault()}}};a.event.special.mouseout={add:function(b){var c=b.handler,d=a(this);d.mouseleave(function(a){return c.apply(d,[a])});b.handler=function(a){a.preventDefault()}}}}})(jQuery);
function LaunchController(a){var b=this;this.process=this.pipe=null;this.parent=a.parent;this.output="";this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.resetObservers=[]}LaunchController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];this.reset()};
LaunchController.prototype.reset=function(a){if(!isNull(a)){a.clearWarnings();a.clearErrors()}this.resetObservers.forEach(function(a){a.release()});this.resetObservers=[];if(!isNull(this.process)){this.process.release();this.process=null}if(!isNull(this.pipe)){this.pipe.release();this.pipe=null}};
LaunchController.prototype.onStart=function(a){var b=this;a.assertArgument("application");this.reset(a);this.process=createProcess();this.resetObservers.push(notificationCenter.addInstanceObserver("Process","Complete",this.process,function(c,d){b.onProcessComplete(a,d)}));this.resetObservers.push(notificationCenter.addInstanceObserver("Process","Ready",this.process,function(c,d){b.onProcessReady(a,d)}));notificationCenter.fire("Task","UpdateView",a,{status:"Launch_Start"});hasOwnProperty(a.args,"application")&&
this.process.setApplicationName(a.getStringArgument("application"));hasOwnProperty(a.args,"workingDirectory")&&this.process.setWorkingDirectory(a.getStringArgument("workingDirectory"));hasOwnProperty(a.args,"arguments")&&(getObjectType(a.args.arguments)=="array"?this.process.setArguments(app.expandString('"'+a.args.arguments.join('" "')+'"')):this.process.setArguments(app.expandString(a.args.arguments)));hasOwnProperty(a.args,"rawArguments")&&this.process.setArguments(a.getStringArgument("rawArguments"));
if(hasOwnProperty(a.args,"elevationRights"))switch(a.args.elevationRights.toLowerCase()){case "user":this.process.setElevationRights(processElevationRights.USER);break;case "elevated":this.process.setElevationRights(processElevationRights.ELEVATED);break;case "asinvoker":this.process.setElevationRights(processElevationRights.INVOKER)}hasOwnProperty(a.args,"sha1")&&this.process.setSha1(app.expandString(a.args.sha1));hasOwnProperty(a.args,"sha1Target")&&this.process.setSha1Target(a.getStringArgument("sha1Target"));
hasOwnProperty(a.args,"authenticateTarget")&&this.process.setAuthenticateTarget(app.expandString(a.args.authenticateTarget));if(hasOwnProperty(a.args,"authenticateType"))switch(a.args.authenticateType.toLowerCase()){case "none":this.process.setAuthenticateType(processAuthenticateType.NONE);break;case "zip":this.process.setAuthenticateType(processAuthenticateType.ZIP);break;case "library":this.process.setAuthenticateType(processAuthenticateType.LIBRARY)}hasOwnProperty(a.args,"showWindow")&&this.process.setShowWindow(a.args.showWindow);
if(hasOwnProperty(a.args,"successOutput")&&host.isMac){this.pipe=createPipe();this.resetObservers.push(notificationCenter.addInstanceObserver("Pipe","Read",this.pipe,function(c,d){b.onPipeRead(a,d)}));this.pipe.setBufferSize(1024);this.pipe.setName(app.expandString("{GUID}"));this.pipe.setOpenExisting(false);this.pipe.start();this.process.setArguments(app.expandString('-c "'+this.process.getApplicationName().split(" ").join("\\ ")+" "+this.process.getArguments()+" &> {PipePath}"+this.pipe.getName()+
";echo **EOP** > {PipePath}"+this.pipe.getName()+'"'));this.process.setApplicationName("/bin/sh")}a.debugPrint("command = {0}\n".format(this.process.getApplicationName()));a.debugPrint("working dir = {0}\n".format(this.process.getWorkingDirectory()));a.debugPrint("args = {0}\n".format(this.process.getArguments()));this.process.launch()};
LaunchController.prototype.onPipeRead=function(a,b){var c=this,d=false,e=false;this.output=this.output+app.base64Decode(b.buffer);if(this.output.indexOf("**EOP**")!=-1){this.output=this.output.replaceAll("**EOP**","");a.debugPrint("output = {0}\n".format(this.output));getObjectType(a.args.successOutput)=="array"?a.args.successOutput.forEach(function(a){c.output.toLowerCase().indexOf(a.toLowerCase())!=-1&&(d=true)}):this.output.indexOf(a.args.successOutput)!=-1&&(d=true);if(d===false){(hasOwnProperty(a.args,
"errorOutputMap")||!isNull(a.args.errorOutputMap))&&$.each(a.args.errorOutputMap,function(b,d){if(c.output.toLowerCase().indexOf(b.toLowerCase())!=-1){a.error(d);e=true}});e===false&&a.error("Launch_Failure")}this.onComplete(a,{successful:d})}};LaunchController.prototype.onProcessReady=function(a,b){if(hasOwnProperty(a.args,"waitForExit")&&a.args.waitForExit===false){notificationCenter.fire("Task","UpdateView",a,{status:"Launch_Complete"});this.onComplete(a,b)}};
LaunchController.prototype.onProcessComplete=function(a,b){var c=false,d=b.exitCode.toString();a.debugPrint("successful {0} exitCode {1}\n".format(b.successful,b.exitCode));if(b.successful===false){a.error("Launch_Failure");this.onComplete(a,b)}else if(!hasOwnProperty(a.args,"successOutput")&&isNull(a.args.successOutput)){hasOwnProperty(a.args,"successCode")&&(getObjectType(a.args.successCode.forEach)==="function"?a.args.successCode.forEach(function(a){b.exitCode===a&&(c=true)}):b.exitCode===a.args.successCode&&
(c=true));if(c!==true){hasOwnProperty(a.args,"warningFlagsMap")&&$.each(a.args.warningFlagsMap,function(d,f){if(thisIs(b.exitCode,Number(d))){a.warning(f);c=true}});hasOwnProperty(a.args,"errorFlagsMap")&&$.each(a.args.errorFlagsMap,function(d,f){if(thisIs(b.exitCode,Number(d))){a.error(f);c=true}});c===false&&(hasOwnProperty(a.args,"warningMap")&&hasOwnProperty(a.args.warningMap,d)?a.warning(a.args.warningMap[d]):hasOwnProperty(a.args,"errorMap")&&hasOwnProperty(a.args.errorMap,d)?a.error(a.args.errorMap[d]):
a.error("Launch_UnknownCode"))}this.onComplete(a,b)}};LaunchController.prototype.onComplete=function(a){!a.hasError()&&!a.hasWarning()&&notificationCenter.fire("Task","UpdateView",a,{status:"Launch_Complete"});a.complete()};registerTaskController("launch",LaunchController);registerTaskView("launch",StatusView);
function LoadInteropController(a){var b=this;this.observers=[];this.skinExtract=createSkinFileExtract();this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("SkinFileExtract","Complete",this.skinExtract,function(c,d){b.onLoad(a,d)}));this.observers.push(notificationCenter.addObserver("App","InteropLoaded",function(c,d){b.onInteropLoaded(a,d)}))}
LoadInteropController.prototype.release=function(){this.skinExtract.release();this.observers.forEach(function(a){a.release()});this.observers=[]};LoadInteropController.prototype.onStart=function(a,b){a.assertArgument("name");a.assertArgument("filename");if(hasOwnProperty(a.args,"skinfilename")){this.skinExtract.setFilename(app.expandString(a.args.skinfilename));this.skinExtract.setOutputFilename(app.expandString(a.args.filename));this.skinExtract.start()}else this.onLoad(a,b)};
LoadInteropController.prototype.onInteropLoaded=function(a,b){var c={},d;d=app.expandString(a.args.filename);if(b.fileName.toLowerCase()===d.toLowerCase()){if(b.successful===true){window.interop.activeInteropLibs.push(a.args.name);mergeObjectProperties(c,a.args);notificationCenter.fireAfterDelay("Interop","DidLoad",0,a,c)}else a.error("Interop_LoadFailed");a.complete(b)}};
LoadInteropController.prototype.onLoad=function(a){var b={},c;c=app.expandString(a.args.filename);mergeObjectProperties(b,a.args);b.cancel=false;notificationCenter.fire("Interop","WillLoad",a,b);if(b.cancel===true){app.debugPrint("Interop load cancelled ({0})".format(a.args.name));a.error("Interop_LoadCancel");a.complete()}else app.loadInterop(c)};registerTaskController("loadInterop",LoadInteropController);
function MacroController(a){var b=this;this.observers=[];this.xhr=null;this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}MacroController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];if(!isNull(this.xhr)){this.xhr.abort();this.xhr=null}};
MacroController.prototype.onStart=function(a){var b=this;if(hasOwnProperty(a.args,"url"))this.xhr=$.getJSON(app.expandString(a.args.url),function(c){b.onContent(a,c)}).error(function(){a.error("Macro_RequestFail");a.complete()});else if(hasOwnProperty(a.args,"content"))if(getObjectType(a.args.content.format)==="function")this.onContent(a,interop.parseJSON(app.expandString(a.args.content)));else this.onContent(a,a.args.content);else a.complete()};
MacroController.prototype.onContent=function(a,b){var c=this;getObjectType(b.forEach)==="function"?b.forEach(function(b){c.addTasks(a,b)}):c.addTasks(a,b)};MacroController.prototype.addTasks=function(a,b){var c=getObjectProperties(b);$.each(c,function(c,e){a.debugPrint("adding macro {0}={1}\n".format(e,b[e]));app.addMacro(e,b[e])});a.complete()};registerTaskController("macro",MacroController);
(function(){function a(){}a.prototype={getTimeEstimate:function(a){if(a<0)return host.getLanguageString("UI_EstimatingTime");if(a<60)return host.getLanguageString("UI_ShortTimeLeft");if(a>604800)return host.getLanguageString("UI_LongTimeLeft");var c="",d=(a/86400).toString().split(".")[0],a=a-d*86400;d>0&&(c=c+(" "+d+host.getLanguageString("UI_DayAbbreviation")));d=(a/3600).toString().split(".")[0];a=a-d*3600;d>0&&(c=c+(" "+d+host.getLanguageString("UI_HourAbbreviation")));a=(a/60).toString().split(".")[0];
a>0&&(c=c+(" "+a+host.getLanguageString("UI_MinuteAbbreviation")));return c.length>0?c+" "+host.getLanguageString("UI_Left"):host.getLanguageString("UI_EstimatingTime")},getTransferSpeed:function(a){return a>=1073741824?(a/1073741824).toFixed(2)+" "+host.getLanguageString("UI_SpeedGB"):a>=1048576?(a/1048576).toFixed(2)+" "+host.getLanguageString("UI_SpeedMB"):a>=1024?(a/1024).toFixed(2)+" "+host.getLanguageString("UI_SpeedKB"):"0.0 "+host.getLanguageString("UI_SpeedKB")},getBytesLeft:function(a){return this.getBytesStr(a)+
" "+host.getLanguageString("UI_BytesLeft")},getBytesRequired:function(a){return this.getBytesStr(a)+" "+host.getLanguageString("UI_BytesRequired")},getBytesFree:function(a){return this.getBytesStr(a)+" "+host.getLanguageString("UI_BytesFree")},getBytesStr:function(a){return(a/1048576).toFixed(2)},getPatchesLeft:function(a){return a+" "+host.getLanguageString("UI_PatchesLeft")},getPatchTitle:function(a,c){var d="",d=c===true?host.getLanguageString("UI_Repairing"):host.getLanguageString("UI_Updating");
d.length>0&&(d=d+" ");return"{0}{1}".format(d,host.getLanguageString(a))}};window.messageFormat=new a})();function NotificationCheckpoint(a,b,c,d,e){var f=this;host.assert(getObjectType(d)==="array","Invaild object type for filters");host.assert(getObjectType(e)==="array","Invaild object type for filters");this.observers=[];this.type=a;this.filters=d;this.reports=e;this.instanceId=app.expandString("{Guid}");this.observers.push(notificationCenter.addObserver(b,c,function(a,b){f.onTrigger(a,b)}))}
NotificationCheckpoint.prototype.checkFilter=function(a,b,c){host.assert(hasOwnProperty(c,"name"),"Filter does not contain name property");if(!hasOwnProperty(c,"value"))return true;var d;d=Tasks.expandValue(a,b,c.name);a=Tasks.expandValue(a,b,c.value);host.assert(getObjectType(d)===getObjectType(a),"Filter trying to compare different types ({0}: {1})".format(this.type,c.name));if(!hasOwnProperty(c,"operator"))c.operator="=";switch(c.operator){case "=":return d===a;case "!=":return d!==a;case ">":return d>
a;case "<":return d<a;case ">=":return d>=a;case "<=":return d<=a;default:host.assert(false,"Unrecognized filter operator in {0}".format(this.type))}return false};NotificationCheckpoint.prototype.expandArguments=function(a,b,c,d){c=Tasks.expandValue(a,b,c);isNull(d)||(c=c.replace(/\{(\d+)\}/g,function(c,f){return hasOwnProperty(d,f)?host.getLanguageString(Tasks.expandValue(a,b,d[f])):host.getLanguageString(Tasks.expandValue(a,b,c))}));return host.getLanguageString(c)};
NotificationCheckpoint.prototype.onTrigger=function(a,b){var c=this,d=true,e={};this.filters.forEach(function(e){d===true&&c.checkFilter(a,b,e)===false&&(d=false)});if(d===true){this.reports.forEach(function(d){host.assert(hasOwnProperty(d,"name"),"Checkpoint report does not contain name property");host.assert(hasOwnProperty(d,"value"),"Checkpoint report {0} does not contain value property".format(d.name));e[d.name]=c.expandArguments(a,b,d.value,d.args)});notificationCenter.fire("NotificationCheckpoint",
c.type,a,e)}};function createNotificationCheckpoint(a,b,c,d,e){return new NotificationCheckpoint(a,b,c,d,e)}
function loadNotificationCheckpoints(a,b){a=app.expandString(a);if(isNull(window.notificationCheckpoints))window.notificationCheckpoints=[];var c={};host.extractJSON(a,function(d){var e=false,f;if(isNull(d))host.assert(false,"Failed to load checkpoint file {0}".format(a));else{c=mergeObjectProperties(c,d);e=true}for(f in c)if(hasOwnProperty(c,f)){d=c[f];host.assert(hasOwnProperty(d,"type"),"Checkpoint file {0} item {1} missing type".format(a,f));host.assert(hasOwnProperty(d,"notificationType"),"Checkpoint file {0} item {1} missing notificationType".format(a,
f));host.assert(hasOwnProperty(d,"notification"),"Checkpoint file {0} item {1} missing notification".format(a,f));host.assert(hasOwnProperty(d,"filters"),"Checkpoint file {0} item {1} missing filters".format(a,f));host.assert(hasOwnProperty(d,"reports"),"Checkpoint file {0} item {1} missing reports".format(a,f));window.notificationCheckpoints.push(createNotificationCheckpoint(d.type,d.notificationType,d.notification,d.filters,d.reports))}isNull(b)||b({successful:e})})}
function NotifyController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));notificationCenter.addObserver("NotificationCheckpoint","ShowNotify",function(c,d){b.onShowNotify(a,d)})}NotifyController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
NotifyController.prototype.onStart=function(a){a.assertArgument("checkpointPath");loadNotificationCheckpoints(a.args.checkpointPath,function(){a.complete()})};NotifyController.prototype.onShowNotify=function(a,b){host.assert(!isNull(b.type),"NotifyController missing type");host.assert(!isNull(b.caption),"NotifyController missing caption");host.assert(!isNull(b.message),"NotifyController missing message");skinWindow.notify(b.type,b.caption,b.message)};registerTaskController("loadNotify",NotifyController);
function OpenController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}OpenController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};OpenController.prototype.onStart=function(a){a.assertArgument("path");platform.shellOpen(a.args.path)===false&&a.error("ShellOpen_Error");a.complete()};registerTaskController("open",OpenController);
$(document).ready(function(){function a(a,b,c,d){var c={id:b,text:host.getLanguageString(c)},e=[],f=1;d.find("option").each(function(){e.push({id:b+f,text:$(this).html()});f=f+1});c.subMenu=e;c.subMenu.length>0&&a.push(c)}function b(a){a.forEach(function(a){hasOwnProperty(a,"subMenu")===true&&b(a.subMenu);skinWindow.setContextMenuSelect(a.id,false)})}function c(){if(window.optionsView.allowContextMenu!==false){var a=[];isNull(window.optionsView.protocolsElement)||window.optionsView.allowWeb===true&&
window.optionsView.allowP2P===true&&a.push(e+1+window.optionsView.protocolsElement.prop("selectedIndex"));isNull(window.optionsView.maxUploadRateElement)||a.push(g+1+window.optionsView.maxUploadRateElement.prop("selectedIndex"));isNull(window.optionsView.maxDownloadRateElement)||a.push(f+1+window.optionsView.maxDownloadRateElement.prop("selectedIndex"));isNull(window.optionsView.maxFileWriteRateElement)||a.push(h+1+window.optionsView.maxFileWriteRateElement.prop("selectedIndex"));isNull(window.optionsView.maxFileReadRateElement)||
a.push(i+1+window.optionsView.maxFileReadRateElement.prop("selectedIndex"));isNull(window.optionsView.langElement)||a.push(j+1+window.optionsView.langElement.prop("selectedIndex"));isNull(window.optionsView.logExpirationDaysElement)||a.push(l+1+window.optionsView.logExpirationDaysElement.prop("selectedIndex"));b(k);a.forEach(function(a){skinWindow.setContextMenuSelect(a,true)})}}var d=null,e=100,f=200,g=300,h=400,i=500,j=600,l=800,k=[];window.optionsView=new function(){this.instanceId=app.expandString("{Guid}");
this.langElement=this.logExpirationDaysElement=this.maxFileReadRateElement=this.maxFileWriteRateElement=this.maxDownloadRateElement=this.maxUploadRateElement=this.protocolsElement=this.rootElement=null;this.allowContextMenu=true;this.allowP2P=app.getConfig("AllowP2P","true").toBoolean();this.allowWeb=app.getConfig("AllowWeb","true").toBoolean()};notificationCenter.fire("OptionsView","Bind",window.optionsView,window.optionsView);if(isNull(window.optionsView.rootElement)&&isNull(window.optionsView.protocolsElement)&&
isNull(window.optionsView.maxUploadRateElement)&&isNull(window.optionsView.maxDownloadRateElement)&&isNull(window.optionsView.maxFileWriteRateElement)&&isNull(window.optionsView.maxFileReadRateElement)&&isNull(window.optionsView.logExpirationDaysElement)&&isNull(window.optionsView.langElement)&&isNull(window.optionsView.formElement))window.optionsView=null;else{if(!isNull(window.optionsView.protocolsElement)&&window.optionsView.allowWeb===false){window.optionsView.protocolsElement.find('option[value="w"]').remove();
window.optionsView.protocolsElement.find('option[value="wp"]').remove()}if(!isNull(window.optionsView.protocolsElement)&&window.optionsView.allowP2P===false){window.optionsView.protocolsElement.find('option[value="p"]').remove();window.optionsView.protocolsElement.find('option[value="wp"]').remove()}if(!isNull(window.optionsView.rootElement)){d=new ChangeClass(window.optionsView.rootElement);isNull(window.optionsView.protocolsElement)||window.optionsView.protocolsElement.change(function(){d.apply("optionChanged")});
isNull(window.optionsView.maxUploadRateElement)||window.optionsView.maxUploadRateElement.change(function(){d.apply("optionChanged")});isNull(window.optionsView.maxDownloadRateElement)||window.optionsView.maxDownloadRateElement.change(function(){d.apply("optionChanged")});isNull(window.optionsView.maxFileWriteRateElement)||window.optionsView.maxFileWriteRateElement.change(function(){d.apply("optionChanged")});isNull(window.optionsView.maxFileReadRateElement)||window.optionsView.maxFileReadRateElement.change(function(){d.apply("optionChanged")});
isNull(window.optionsView.langElement)||window.optionsView.langElement.change(function(){d.apply("optionChanged")});isNull(window.optionsView.logExpirationDaysElement)||window.optionsView.logExpirationDaysElement.change(function(){d.apply("optionChanged")});window.optionsView.rootElement.find("form").submit(function(){d.apply(null);if(!isNull(window.optionsView.protocolsElement)){var a=window.optionsView.protocolsElement.attr("value");settings.set("webEnabled",a.indexOf("w")!==-1&&window.optionsView.allowWeb===
true);settings.set("p2pEnabled",a.indexOf("p")!==-1&&window.optionsView.allowP2P===true)}isNull(window.optionsView.maxUploadRateElement)||settings.set("maxUploadRate",parseInt(window.optionsView.maxUploadRateElement.attr("value"),10));isNull(window.optionsView.maxDownloadRateElement)||settings.set("maxDownloadRate",parseInt(window.optionsView.maxDownloadRateElement.attr("value"),10));isNull(window.optionsView.maxFileWriteRateElement)||settings.set("maxFileWriteRate",parseInt(window.optionsView.maxFileWriteRateElement.attr("value"),
10));isNull(window.optionsView.maxFileReadRateElement)||settings.set("maxFileReadRate",parseInt(window.optionsView.maxFileReadRateElement.attr("value"),10));isNull(window.optionsView.logExpirationDaysElement)||settings.set("logExpirationDays",parseInt(window.optionsView.logExpirationDaysElement.attr("value"),10));isNull(window.optionsView.langElement)||settings.set("language",window.optionsView.langElement.attr("value"));return false})}if(!isNull(window.optionsView.langElement)){window.optionsView.langElement.attr("value",
app.expandString("{Language}-{Country}"));window.optionsView.langElement.prop("selectedIndex")<0&&window.optionsView.langElement.prop("selectedIndex",0)}if(window.optionsView.allowContextMenu===true){notificationCenter.addInstanceObserver("SkinWindow","ContextMenuSelect",skinWindow,function(a,b){var c=null;if(b.id>=l){window.optionsView.logExpirationDaysElement.prop("selectedIndex",b.id-1-l);c=window.optionsView.logExpirationDaysElement.parents("form:first")}else if(b.id>=700)app.closeAll();else if(b.id>=
j){window.optionsView.langElement.prop("selectedIndex",b.id-1-j);c=window.optionsView.langElement.parents("form:first")}else if(b.id>=i){window.optionsView.maxFileReadRateElement.prop("selectedIndex",b.id-1-i);c=window.optionsView.maxFileReadRateElement.parents("form:first")}else if(b.id>=h){window.optionsView.maxFileWriteRateElement.prop("selectedIndex",b.id-1-h);c=window.optionsView.maxFileWriteRateElement.parents("form:first")}else if(b.id>=g){window.optionsView.maxUploadRateElement.prop("selectedIndex",
b.id-1-g);c=window.optionsView.maxUploadRateElement.parents("form:first")}else if(b.id>=f){window.optionsView.maxDownloadRateElement.prop("selectedIndex",b.id-1-f);c=window.optionsView.maxDownloadRateElement.parents("form:first")}else if(b.id>=e){window.optionsView.protocolsElement.prop("selectedIndex",b.id-1-e);c=window.optionsView.protocolsElement.parents("form:first")}isNull(c)||c.submit()});notificationCenter.addInstanceObserver("SkinWindow","L18NComplete",skinWindow,function(){k=[];isNull(window.optionsView.protocolsElement)||
window.optionsView.allowWeb===true&&window.optionsView.allowP2P===true&&a(k,e,"UI_DownloadType",window.optionsView.protocolsElement);isNull(window.optionsView.maxUploadRateElement)||a(k,g,"UI_MaxUpload",window.optionsView.maxUploadRateElement);isNull(window.optionsView.maxDownloadRateElement)||a(k,f,"UI_MaxDownload",window.optionsView.maxDownloadRateElement);isNull(window.optionsView.maxFileWriteRateElement)||a(k,h,"UI_MaxFileWrite",window.optionsView.maxFileWriteRateElement);isNull(window.optionsView.maxFileReadRateElement)||
a(k,i,"UI_MaxFileRead",window.optionsView.maxFileReadRateElement);if(!isNull(window.optionsView.logExpirationDaysElement)){k.length>0&&k.push({id:j,text:"-"});a(k,l,"UI_LogExpirationDays",window.optionsView.logExpirationDaysElement)}if(!isNull(window.optionsView.langElement)){k.length>0&&k.push({id:j,text:"-"});a(k,j,"UI_Language",window.optionsView.langElement)}if(host.isWin===true){k.length>0&&k.push({id:700,text:"-"});k.push({id:701,text:host.getLanguageString("UI_Exit")})}skinWindow.setContextMenu(JSON.stringify(k));
c()})}notificationCenter.addInstanceObserver("Settings","DidChange",settings,function(a,b){var d="";switch(b.key){case "language":if(!isNull(window.optionsView.langElement)){window.optionsView.langElement.attr("value",b.newValue);c()}break;case "logExpirationDays":if(!isNull(window.optionsView.logExpirationDaysElement)){window.optionsView.logExpirationDaysElement.attr("value",b.newValue);c()}break;case "webEnabled":case "p2pEnabled":if(!isNull(window.optionsView.protocolsElement)){settings.get("webEnabled")===
true&&window.optionsView.allowWeb===true&&(d=d+"w");settings.get("p2pEnabled")===true&&window.optionsView.allowP2P===true&&(d=d+"p");if(d.length>0){window.optionsView.protocolsElement.attr("value",d);c()}}break;case "maxUploadRate":if(!isNull(window.optionsView.maxUploadRateElement)){window.optionsView.maxUploadRateElement.attr("value",b.newValue);c()}break;case "maxDownloadRate":if(!isNull(window.optionsView.maxDownloadRateElement)){window.optionsView.maxDownloadRateElement.attr("value",b.newValue);
c()}break;case "maxFileWriteRate":if(!isNull(window.optionsView.maxFileWriteRateElement)){window.optionsView.maxFileWriteRateElement.attr("value",b.newValue);c()}break;case "maxFileReadRate":if(!isNull(window.optionsView.maxFileReadRateElement)){window.optionsView.maxFileReadRateElement.attr("value",b.newValue);c()}}})}});
function OSError(){this.ERROR_SUCCESS=0;this.ERROR_FILE_NOT_FOUND=2;this.ERROR_PATH_NOT_FOUND=3;this.ERROR_TOO_MANY_OPEN_FILES=4;this.ERROR_ACCESS_DENIED=5;this.ERROR_INVALID_DRIVE=15;this.ERROR_WRITE_PROTECT=19;this.ERROR_SHARING_VIOLATION=32;this.ERROR_LOCK_VIOLATION=33;this.ERROR_HANDLE_DISK_FULL=39;this.ERROR_BAD_NET_NAME=67;this.ERROR_FILE_EXISTS=80;this.ERROR_DRIVE_LOCKED=108;this.ERROR_DISK_FULL=112;this.ERROR_INVALID_NAME=123;this.ERROR_BAD_PATHNAME=161;this.ESUCCESS=0;this.EPERM=1;this.ENOENT=
2;this.EBADF=9;this.EAGAIN=11;this.EACCES=13;this.EBUSY=16;this.EEXIST=17;this.ENODEV=19;this.EISDIR=21;this.ENOTDIR=20;this.ENFILE=22;this.EFBIG=27;this.ENOSPC=28;this.ESPIPE=29;this.EROFS=30;this.EMLINK=31;this.EDEADLK=35;this.ENAMETOOLONG=36}
OSError.prototype.nameFromIdWin=function(a){switch(a){case this.ERROR_SUCCESS:return"None";case this.ERROR_FILE_NOT_FOUND:case this.ERROR_INVALID_DRIVE:case this.ERROR_INVALID_NAME:case this.ERROR_BAD_PATHNAME:case this.ERROR_PATH_NOT_FOUND:case this.ERROR_ALREADY_EXISTS:case this.ERROR_FILE_EXISTS:case this.ERROR_BAD_NET_NAME:case this.ERROR_TOO_MANY_OPEN_FILES:return"AccessInvalid";case this.ERROR_ACCESS_DENIED:case this.ERROR_WRITE_PROTECT:return"AccessDenied";case this.ERROR_DRIVE_LOCKED:case this.ERROR_LOCK_VIOLATION:case this.ERROR_SHARING_VIOLATION:return"Locked";
case this.ERROR_DISK_FULL:case this.ERROR_HANDLE_DISK_FULL:return"NotEnoughSpace"}return"Unknown"};
OSError.prototype.nameFromIdMac=function(a){switch(a){case this.ESUCCESS:return"None";case this.EPERM:case this.EAGAIN:case this.EACCES:case this.EBUSY:case this.EROFS:return"AccessDenied";case this.ENOENT:case this.EBADF:case this.EEXIST:case this.ENODEV:case this.EISDIR:case this.ENOTDIR:case this.ENFILE:case this.EFBIG:case this.ESPIPE:case this.EMLINK:case this.ENAMETOOLONG:return"AccessInvalid";case this.ENOSPC:return"NotEnoughSpace";case this.EDEADLK:return"Locked"}return"Unknown"};
OSError.prototype.nameFromId=function(a){return host.isWin===true?this.nameFromIdWin(a):host.isMac===true?this.nameFromIdMac(a):"Unknown"};OSError.prototype.isUnknown=function(a){return this.nameFromId(a).toLowerCase()==="unknown"?true:false};var osError=new OSError;
$(document).ready(function(){function a(){this.instanceId=app.expandString("{Guid}");this.numGraphPoints=40;this.legendPosition="nw";this.legendColumnCount=1;this.graphElement=this.outgoingMaxSpeedElement=this.incomingMaxSpeedElement=this.outgoingCurSpeedElement=this.incomingCurSpeedElement=this.outgoingAvgSpeedElement=this.incomingAvgSpeedElement=this.colors=null}function b(a,b){for(var c=[],d=0,b=Math.max(b,1),d=0;d<window.performanceView.numGraphPoints;d=d+1)c.push([d,a[d]/b]);return c}function c(a,
b){for(var c=0,c=0;c<window.performanceView.numGraphPoints;c=c+1)if(b!==a[c])return true;return false}a.prototype.onUpdateElement=function(a,b){if(!isNull(a)){var c=a.html();if(c!==b){a.html(b);a.trigger("changed",[c,b])}}};window.performanceView=new a;notificationCenter.fire("PerformanceView","Bind",window.performanceView,window.performanceView);if(isNull(window.performanceView.incomingAvgSpeedElement)&&isNull(window.performanceView.outgoingAvgSpeedElement)&&isNull(window.performanceView.incomingCurSpeedElement)&&
isNull(window.performanceView.outgoingCurSpeedElement)&&isNull(window.performanceView.incomingMaxSpeedElement)&&isNull(window.performanceView.outgoingMaxSpeedElement)&&isNull(window.performanceView.graphElement))window.performanceView=null;else{var d=null,e=null,f=null,g=[],h=[],i=0,j=0;notificationCenter.addInstanceObserver("SkinWindow","DidClose",skinWindow,function(){if(!isNull(f)){clearInterval(f);f=null}window.performanceView=null});for(j=0;j<window.performanceView.numGraphPoints;j=j+1){g.push(0);
h.push(0)}d={legend:{show:true,backgroundColor:"transparent",position:window.performanceView.legendPosition,noColumns:window.performanceView.legendColumnCount},grid:{show:false,borderWidth:0},series:{shadowSize:0,lines:{show:true,lineWidth:1,fill:true}},xaxis:{show:false,min:0,max:window.performanceView.numGraphPoints-1,alignTicksWithAxis:1},yaxis:{show:false,min:0,max:1}};if(!isNull(window.performanceView.colors))d.colors=window.performanceView.colors;isNull(window.performanceView.graphElement)||
(e=$.plot(window.performanceView.graphElement,[{label:host.getLanguageString("UI_Incoming"),data:b(g,0)},{label:host.getLanguageString("UI_Outgoing"),data:b(h,0)}],d));f=setInterval(function(){var a,d=false;a=isNull(window.downloader)?{incoming:{current:0,average:0,max:0},outgoing:{current:0,average:0,max:0}}:interop.parseJSON(downloader.getTransferRates());if(c(g,a.incoming.current)===true||c(h,a.outgoing.current)===true){g.shift();h.shift();g.push(a.incoming.current);h.push(a.outgoing.current);
d=1;for(j=0;j<window.performanceView.numGraphPoints;j=j+1){d=Math.max(d,g[j]);d=Math.max(d,h[j])}i=d;d=true;host.assert(g.length<=window.performanceView.numGraphPoints,"Performance view incoming data overflow ({0} > {1})".format(g.length,window.performanceView.numGraphPoints));host.assert(h.length<=window.performanceView.numGraphPoints,"Performance view outgoingData data overflow ({0} > {1})".format(h.length,window.performanceView.numGraphPoints))}if(!isNull(e)&&d===true&&window.performanceView.graphElement.is(":visible")){e.setData([{label:host.getLanguageString("UI_Incoming"),
data:b(g,i)},{label:host.getLanguageString("UI_Outgoing"),data:b(h,i)}]);e.draw()}window.performanceView.onUpdateElement(window.performanceView.incomingCurSpeedElement,messageFormat.getTransferSpeed(a.incoming.current));window.performanceView.onUpdateElement(window.performanceView.outgoingCurSpeedElement,messageFormat.getTransferSpeed(a.outgoing.current));window.performanceView.onUpdateElement(window.performanceView.incomingAvgSpeedElement,messageFormat.getTransferSpeed(a.incoming.average));window.performanceView.onUpdateElement(window.performanceView.outgoingAvgSpeedElement,
messageFormat.getTransferSpeed(a.outgoing.average));window.performanceView.onUpdateElement(window.performanceView.incomingMaxSpeedElement,messageFormat.getTransferSpeed(a.incoming.max));window.performanceView.onUpdateElement(window.performanceView.outgoingMaxSpeedElement,messageFormat.getTransferSpeed(a.outgoing.max))},1E3)}});function Pipe(a){this.instanceId=a}Pipe.prototype.release=function(){interop.releaseInstance(this.instanceId)};
Pipe.prototype.getName=function(){return interop.invoke(this.instanceId,{method:"getName"})};Pipe.prototype.setName=function(a){return interop.invoke(this.instanceId,{method:"setName",value:a})};Pipe.prototype.getBufferSize=function(){return interop.invoke(this.instanceId,{method:"getBufferSize"})};Pipe.prototype.setBufferSize=function(a){return interop.invoke(this.instanceId,{method:"setBufferSize",value:a})};Pipe.prototype.getOpenExisting=function(){return interop.invoke(this.instanceId,{method:"getOpenExisting"})};
Pipe.prototype.setOpenExisting=function(a){return interop.invoke(this.instanceId,{method:"setOpenExisting",value:a})};Pipe.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};Pipe.prototype.write=function(a){return interop.invoke(this.instanceId,{method:"write",buffer:a})};function createPipe(){return interop.createInstance("SSN.Pipe",Pipe)}function Process(a){this.instanceId=a}Process.prototype.release=function(){interop.releaseInstance(this.instanceId)};
Process.prototype.getApplicationName=function(){return interop.invoke(this.instanceId,{method:"getApplicationName"})};Process.prototype.setApplicationName=function(a){return interop.invoke(this.instanceId,{method:"setApplicationName",value:a})};Process.prototype.getShortApplicationName=function(){return interop.invoke(this.instanceId,{method:"getShortApplicationName"})};Process.prototype.getRunningTime=function(){return interop.invoke(this.instanceId,{method:"getRunningTime"})};
Process.prototype.getId=function(){return interop.invoke(this.instanceId,{method:"getId"})};Process.prototype.getArguments=function(){return interop.invoke(this.instanceId,{method:"getArguments"})};Process.prototype.setArguments=function(a){return interop.invoke(this.instanceId,{method:"setArguments",value:a})};Process.prototype.getWorkingDirectory=function(){return interop.invoke(this.instanceId,{method:"getWorkingDirectory"})};
Process.prototype.setWorkingDirectory=function(a){return interop.invoke(this.instanceId,{method:"setWorkingDirectory",value:a})};Process.prototype.getShowWindow=function(){return interop.invoke(this.instanceId,{method:"getShowWindow"})};Process.prototype.setShowWindow=function(a){return interop.invoke(this.instanceId,{method:"setShowWindow",value:a})};Process.prototype.getElevationRights=function(){return interop.invoke(this.instanceId,{method:"getElevationRights"})};
Process.prototype.setElevationRights=function(a){return interop.invoke(this.instanceId,{method:"setElevationRights",value:a})};Process.prototype.getSha1=function(){return interop.invoke(this.instanceId,{method:"getSha1"})};Process.prototype.setSha1=function(a){return interop.invoke(this.instanceId,{method:"setSha1",value:a})};Process.prototype.getSha1Target=function(){return interop.invoke(this.instanceId,{method:"getSha1Target"})};
Process.prototype.setSha1Target=function(a){return interop.invoke(this.instanceId,{method:"setSha1Target",value:a})};Process.prototype.getAuthenticateType=function(){return interop.invoke(this.instanceId,{method:"getAuthenticateType"})};Process.prototype.setAuthenticateType=function(a){return interop.invoke(this.instanceId,{method:"setAuthenticateType",value:a})};Process.prototype.getAuthenticateTarget=function(){return interop.invoke(this.instanceId,{method:"getAuthenticateTarget"})};
Process.prototype.setAuthenticateTarget=function(a){return interop.invoke(this.instanceId,{method:"setAuthenticateTarget",value:a})};Process.prototype.launch=function(){return interop.invoke(this.instanceId,{method:"launch"})};function createProcess(){return interop.createInstance("SSN.Process",Process)}function ProcessAuthenticateType(){this.NONE=0;this.LIBRARY=1;this.ZIP=2}ProcessAuthenticateType.prototype.nameFromId=function(a){return["None","Library","Zip"][a]};var processAuthenticateType=new ProcessAuthenticateType;
function ProcessElevationRights(){this.USER=0;this.ELEVATED=1;this.INVOKER=2}ProcessElevationRights.prototype.nameFromId=function(a){return["User","Elevated","Invoker"][a]};var processElevationRights=new ProcessElevationRights;
function ProgressController(a,b){var c=this;this.instanceId=app.expandString("{Guid}");this.bounds={};this.intervalTimerId=null;this.intervalTaskArgs={progressWaitPaused:false};this.maxPercentage=100;if(b.maxPercentage)this.maxPercentage=Number(b.maxPercentage);this.progressCompleteAllowed=false;if(b.type==="progress")this.progressCompleteAllowed=true;this.progressTask=a;this.incompletedTasks=[];this.observers=[];this.observers.push(notificationCenter.addObserver("Task","Start",function(a,b){c.onTaskStart(a,
b)}));this.observers.push(notificationCenter.addObserver("Task","Complete",function(a,b){c.onTaskComplete(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Progress","TogglePause",c,function(){if(c.intervalTimerId!=null&&c.intervalTaskArgs)c.intervalTaskArgs.progressWaitPaused=!c.intervalTaskArgs.progressWaitPaused}))}ProgressController.prototype.stopIntervalTimer=function(){if(!isNull(this.intervalTimerId)){clearTimeout(this.intervalTimerId);this.intervalTimerId=null}};
ProgressController.prototype.release=function(){isNull(this.view)||this.view.release();this.stopIntervalTimer();this.bounds={};this.observers.forEach(function(a){a.release()});this.observers=[]};
ProgressController.prototype.onTaskStart=function(a,b){var c=this;if(a===c.progressTask)c.onStart(a,b);if(a.name&&c.bounds[a.name]&&c.bounds[a.name].progressWeight>0){var d=c.bounds[a.name];if(d.progressWaitTime>0){notificationCenter.fire("Progress","Progress",c.progressTask,d.pctRange[0]);var e=1;Number(d.progressWaitInterval)>0&&(e=Number(d.progressWaitInterval));var f=(d.pctRange[1]-d.pctRange[0])*d.progressWaitLimit,g=f/(d.progressWaitTime/e);c.stopIntervalTimer();var h=d.pctRange[0]+f,i=d.pctRange[0];
c.intervalTaskArgs=d;c.intervalTimerId=setInterval(function(){if(d.progressWaitPaused!==true)if(i>=h)c.stopIntervalTimer();else{g>h-i&&(g=(h-i)/2);i=i+g;notificationCenter.fire("Progress","Progress",c.progressTask,i)}},e*1E3)}else if(a.view&&a.args)var j=notificationCenter.addInstanceObserver("TaskView","WillUpdateProgress",a.view,function(a,b){var e=d.pctRange[0],f=d.pctRange[1]-e;b.percent<=100&&notificationCenter.fire("Progress","Progress",c.progressTask,e+b.percent/100*f)}),l=notificationCenter.addInstanceObserver("Task",
"Complete",a,function(){j.release();l.release()});else notificationCenter.fire("Progress","Progress",c.progressTask,d.pctRange[0])}};
ProgressController.prototype.onTaskComplete=function(a){if(a!==this.progressTask&&a.name){this.bounds[a.name]&&this.bounds[a.name].progressWeight>0&&this.bounds[a.name].progressWaitTime>0&&this.stopIntervalTimer();var b=this.incompletedTasks.indexOf(a.name);if(b>=0){this.incompletedTasks.splice(b,1);if(this.incompletedTasks.length===0){a.hasError()||notificationCenter.fire("Progress","Progress",this.progressTask,this.maxPercentage/100);this.release()}}}};
ProgressController.prototype.getNextTaskNames=function(a,b,c){var d=[],e=a.actions;if(e&&!c&&getObjectType(e.forEach)==="function")for(c=0;c<e.length;c++)e[c]&&d.push(app.expandString(e[c]));if(getObjectType(b.forEach)==="function")for(c=0;c<b.length;c++){if(a[b[c]]){d.push(app.expandString(a[b[c]]));break}}else a[b]&&d.push(app.expandString(a[b]));return d};
ProgressController.prototype.createProgressArguments=function(a){var b={progressWeight:-1,progressWaitTime:0,progressWaitLimit:1,progressWaitInterval:0,progressWaitPaused:false,pctRange:[0,0]};if(!isNull(a.progressWeight))b.progressWeight=a.progressWeight;if(a.progressWaitTime){b.progressWaitTime=a.progressWaitTime;if(a.progressWaitInterval)b.progressWaitInterval=a.progressWaitInterval;if(a.progressWaitLimit)b.progressWaitLimit=a.progressWaitLimit;if(a.progressWaitPaused)b.progressWaitPaused=a.progressWaitPaused==
true}return b};
ProgressController.prototype.onStart=function(a){var b="complete";if(a.args.taskChainParameter)b=a.args.taskChainParameter;var c=[],d=[],e,f;e=this.getNextTaskNames(a.args,b,false);for(a=e.length-1;a>=0;a=a-1)d.push(e[a]);for(;d.length>0;){e=d.pop();f=window.workflow.tasks.tasks[e];window.workflow.tasks.tasks[e].normalizeProgress=true;if(f&&c.indexOf(e)<0){c.push(e);if(!hasOwnProperty(f,"taskChainEnd")||!f.taskChainEnd){e=this.getNextTaskNames(f,b,false);for(a=e.length-1;a>=0;a=a-1)d.push(e[a])}}}var g=1,
d=[],b=[];this.incompletedTasks=[];for(a=0;a<c.length;a=a+1){e=c[a];f=window.workflow.tasks.tasks[e];f=this.createProgressArguments(f);if(f.progressWeight!==0){this.bounds[e]=f;f.progressWeight>0&&f.progressWeight<=1?g=g-f.progressWeight:d.push(e);b.push(e)}this.incompletedTasks.push(e)}if(g>0&&d.length>0){c=g/d.length;for(a=0;a<d.length;a=a+1)this.bounds[d[a]].progressWeight=c}c=0.1;for(a=0;a<b.length;a=a+1){e=c+this.maxPercentage*this.bounds[b[a]].progressWeight;if(e>this.maxPercentage)e=this.maxPercentage;
this.bounds[b[a]].pctRange=[c/100,e/100];c=e}this.progressCompleteAllowed===true&&this.progressTask.complete()};registerTaskController("progress",ProgressController);
function ProgressView(a){var b=this;this.observers=[];this.controller=a.controller;this.progressBarElement=this.progressElement=null;this.showInTaskbar=true;this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","Complete",a,function(){b.onTaskComplete()}));this.observers.push(notificationCenter.addInstanceObserver("Progress","Progress",a,function(a,d){b.onUpdateProgress(d)}));this.observers.push(notificationCenter.addInstanceObserver("Workflow",
"WillUnload",workflow,function(){b.release()}))}ProgressView.prototype.release=function(){if(!isNull(this.progressBarElementClass)){this.progressBarElementClass.release();this.progressBarElementClass=null}if(!isNull(this.controller)){this.controller.release();this.controller=null}this.observers.forEach(function(a){a.release()});this.observers=[]};
ProgressView.prototype.onStart=function(a){notificationCenter.fire("ProgressView","Bind",a,this);host.assert(!isNull(this.progressBarElement),"ProgressView binding did not assign progressBarElement element");this.progressBarElementClass=new ChangeClass(this.progressBarElement)};ProgressView.prototype.onTaskComplete=function(){this.showInTaskbar===true&&skinWindow.setTaskbarProgress(-2)};
ProgressView.prototype.onUpdateProgress=function(a){a=parseInt(a*100,10);if(a!==this.lastPercent){this.showInTaskbar===true&&skinWindow.setTaskbarProgress(a);this.lastPercent=a;if(!isNull(this.progressElement)){var b=Math.max(a,0)+"%",c=this.progressElement.html();if(c!==b){this.progressElement.html(b);this.progressElement.trigger("changed",[c,b])}}if(!isNull(this.progressBarElement)){if(a<0){this.progressBarElement.width("100%");this.progressBarElementClass.apply("indefinite")}else{this.progressBarElementClass.apply(null);
host.isIE6===true?this.progressBarElement.width(Math.max(a,1)+"%"):this.progressBarElement.width(a+"%")}this.progressBarElement.trigger("updateProgress",a)}}};registerTaskView("progress",ProgressView);
function QueueController(a){var b=this;this.observers=[];this.pendingTasks=this.currentActionIndex=this.totalActions=0;this.concurrentTasks=1;this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","NextTask",a,function(c,d){b.onNextTask(a,d)}))}QueueController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
QueueController.prototype.onStart=function(a,b){a.assertArgument("actions");this.totalActions=a.args.actions.length;this.onQueueStart(a,b)};
QueueController.prototype.onQueueStart=function(a,b){var c;if(hasOwnProperty(a.args,"concurrentTasks")){this.concurrentTasks=a.args.concurrentTasks;if(this.concurrentTasks==-1)this.concurrentTasks=this.totalActions;this.concurrentTasks=Math.min(this.concurrentTasks,this.totalActions)}for(c=0;c<this.concurrentTasks;++c)notificationCenter.fire("Task","NextTask",a,{});if(this.concurrentTasks===0)this.onQueueComplete(a,b)};
QueueController.prototype.onRunSubTask=function(a,b,c){a.runSubTask(a.args.actions[this.currentActionIndex],null,function(a,b){c(b)})};
QueueController.prototype.onNextTask=function(a,b){var c=this,d=function(d){c.pendingTasks=c.pendingTasks-1;isNull(d)||mergeObjectProperties(b,d,true);if(a.hasError()===false)notificationCenter.fire("Task","NextTask",a,{});else if(c.pendingTasks===0)c.onQueueComplete(a,b)};if(this.currentActionIndex<this.totalActions){this.pendingTasks=this.pendingTasks+1;this.onRunSubTask(a,b,d);this.currentActionIndex=this.currentActionIndex+1}if(this.pendingTasks===0)this.onQueueComplete(a,b)};
QueueController.prototype.onQueueComplete=function(a,b){a.complete(b)};registerTaskController("queue",QueueController);function RegistryKeyController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}RegistryKeyController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
RegistryKeyController.prototype.RegistryKeyAdd=function(a){var b=false;switch(getObjectType(a.value)){case "string":b=platform.setRegistryString(a.view,a.security,a.hive,app.expandString(a.location),app.expandString(a.key),app.expandString(a.value));break;default:b=platform.setRegistryInt32(a.view,a.security,a.hive,app.expandString(a.location),app.expandString(a.key),a.value)}return b};
RegistryKeyController.prototype.onRegistryKeyAdd=function(a){a.assertArgument("key");a.assertArgument("value");if(isNull(a.args.security))a.args.security="default";this.RegistryKeyAdd(a.args)===false&&a.error("RegistryKey_AddFail");a.complete()};
RegistryKeyController.prototype.onRegistryKeyAddBlock=function(a){a.assertArgument("block");if(isNull(a.args.security))a.args.security="default";var b=this,c=a.args.block.length>0;$.each(a.args.block,function(d,e){entry={};entry.key=d;entry.value=e;entry.security=a.args.security;entry.hive=a.args.hive;entry.location=a.args.location;entry.view=a.args.view;c=b.RegistryKeyAdd(entry)&&c});c===false&&a.error("RegistryKey_AddFail");a.complete()};
RegistryKeyController.prototype.onRegistryKeyDelete=function(a){platform.registryDeleteKey(a.args.view,a.args.hive,a.args.location);a.complete()};RegistryKeyController.prototype.onRegistryKeyExists=function(a){function b(){a.complete()}platform.registryKeyPathExists(a.args.view,a.args.hive,a.args.location)?a.runSubAction("exists",null,b):a.runSubAction("missing",null,b)};
RegistryKeyController.prototype.onRegistryKeyCompare=function(a){function b(){a.complete()}a.assertArgument("key");a.assertArgument("value");var c=null;if(platform.registryKeyPathExists(a.args.view,a.args.hive,a.args.location))switch(getObjectType(a.args.value)){case "string":c=platform.getRegistryString(a.args.view,a.args.hive,a.args.location,a.args.key,"");break;default:c=platform.getRegistryInt32(a.args.view,a.args.hive,a.args.location,a.args.key,0)}isNull(c)?a.runSubAction("missing",null,b):c===
a.args.value?a.runSubAction("equalTo",null,b):c>a.args.value?a.runSubAction("greaterThan",null,b):a.runSubAction("lessThan",null,b)};
RegistryKeyController.prototype.onRegistryKeyCompareVersion=function(a){function b(){a.complete()}var c,d,e,f,g;a.assertArgument("key");a.assertArgument("value");if(isNull(a.args.delimiter))a.args.delimiter=".";platform.registryKeyPathExists(a.args.view,a.args.hive,a.args.location)&&(c=platform.getRegistryString(a.args.view,a.args.hive,a.args.location,a.args.key,""));if(isNull(c))a.runSubAction("missing",null,function(){a.complete()});else{f=c.split(a.args.delimiter);g=a.args.value.split(a.args.delimiter);
for(c=0;c<Math.max(f.length,g.length);c=c+1){d=0;c<f.length&&(d=parseInt(f[c],10));e=0;c<g.length&&(e=g[c]);if(d>e){a.runSubAction("greaterThan",null,b);return}if(d<e){a.runSubAction("lessThan",null,b);return}}a.runSubAction("equalTo",null,b)}};
RegistryKeyController.prototype.onStart=function(a,b){a.assertArgument("hive");a.assertArgument("location");if(isNull(a.args.view))a.args.view="default";switch(a.args.type){case "addRegistryKey":this.onRegistryKeyAdd(a,b);break;case "addRegistryKeyBlock":this.onRegistryKeyAddBlock(a,b);break;case "deleteRegistryKey":this.onRegistryKeyDelete(a,b);break;case "checkRegistryKeyExists":this.onRegistryKeyExists(a,b);break;case "compareRegistryKey":this.onRegistryKeyCompare(a,b);break;case "compareVersionRegistryKey":this.onRegistryKeyCompareVersion(a,
b);break;default:host.assert(false,"Unknown type in RegistryKeyController ({0})".format(a.args.type))}a.complete()};registerTaskController("addRegistryKey",RegistryKeyController);registerTaskController("addRegistryKeyBlock",RegistryKeyController);registerTaskController("deleteRegistryKey",RegistryKeyController);registerTaskController("checkRegistryKeyExists",RegistryKeyController);registerTaskController("compareRegistryKey",RegistryKeyController);
registerTaskController("compareVersionRegistryKey",RegistryKeyController);
(function(){function a(){this.notificationObservers={};this.instanceId="Global";this.verbose=false}a.prototype.ensureCreated=function(a,b,e){var f;if(hasOwnProperty(this.notificationObservers,a)===false){f={};this.notificationObservers[a]=f}else f=this.notificationObservers[a];if(hasOwnProperty(f,b)===false){a={};f[b]=a}else a=f[b];if(hasOwnProperty(a,e)===false){b=[];a[e]=b}else b=a[e];return b};a.prototype.addObserver=function(a,b,e){return this.addInstanceObserver(a,b,this,e)};a.prototype.addInstanceObserver=
function(a,b,e,f){if(hasOwnProperty(e,"instanceId")===false)app.debugPrint("RemoteNotificationCenter requires instance to have unqiue instanceId\n");else{this.verbose&&app.debugPrint("RemoteNotificationCenter addInstanceObs {0} {1} on {2}\n".format(a,b,e.instanceId));this.ensureCreated(a,b,e.instanceId).push(f);return{release:function(){remoteNotificationCenter.removeInstanceObserver(a,b,e,f)}}}};a.prototype.removeInstanceObserver=function(a,b,e,f){this.ensureCreated(a,b,e.instanceId).removeElement(f)===
false&&(e===this?app.debugPrint("RemoteNotificationCenter unable to remove global observer {0} {1}\n".format(a,b)):app.debugPrint("RemoteNotificationCenter unable to remove instance observer {0} {1} {2}\n".format(a,b,e.instanceId)));this.notificationObservers[a][b][e.instanceId].length===0&&delete this.notificationObservers[a][b][e.instanceId]};a.prototype.fireAfterDelay=function(a,b,e,f,g,h){setTimeout(function(){notificationCenter.fire(a,b,f,g,h)},e)};a.prototype.fire=function(a,b,e,f,g){if(hasOwnProperty(this.notificationObservers,
a)!==false&&hasOwnProperty(this.notificationObservers[a],b)!==false)if(hasOwnProperty(e,"instanceId")===false)app.debugPrint("RemoteNotificationCenter requires sender to have unique instanceId\n");else if(hasOwnProperty(f,"instanceId")===false)app.debugPrint("RemoteNotificationCenter requires sendto to have unique instanceId\n");else{hasOwnProperty(this.notificationObservers[a][b],f.instanceId)===true&&this.notificationObservers[a][b][f.instanceId].forEachReverse(function(a){isNull(a)||a(e,f,g)});
hasOwnProperty(this.notificationObservers[a][b],this.instanceId)===true&&this.notificationObservers[a][b][this.instanceId].forEachReverse(function(a){isNull(a)||a(e,f,g)})}};a.prototype.messageDispatcher=function(a,b){var e=interop.parseJSON(b.message);if(hasOwnProperty(e,"type")&&hasOwnProperty(e,"typename")&&hasOwnProperty(e,"notification")&&hasOwnProperty(e,"sender"))switch(e.type){case "remoteNotification":this.verbose&&app.debugPrint("RemoteNotificationCenter message {0} {1} from {2} to {3}\n".format(e.typename,
e.notification,e.sender,a.instanceId));remoteNotificationCenter.fire(e.typename,e.notification,{instanceId:e.sender},a,e.params)}};a.prototype.addEndpoint=function(a){this.verbose&&app.debugPrint("RemoteNotificationCenter addEndpoint {0}\n".format(a.instanceId));notificationCenter.addInstanceObserver("SkinWindow","Message",a,this.messageDispatcher)};a.prototype.removeEndpoint=function(a){this.verbose&&app.debugPrint("RemoteNotificationCenter removeEndpoint {0}\n".format(a.instanceId));notificationCenter.removeInstanceObserver("SkinWindow",
"Message",a,this.messageDispatcher)};a.prototype.send=function(a,b,e,f,g){f.sendMessage(JSON.stringify({type:"remoteNotification",typename:a,notification:b,sender:e.instanceId,params:g}))};a.prototype.sendWithWait=function(a,b,e,f,g,h){if(isNull(h)||typeof h!=="function")app.debugPrint("RemoteNotificationCenter sendWithWait requires a shouldWait function "+typeof h+"\n");else if(h(e,g)===false)setTimeout(function(){remoteNotificationCenter.sendWithWait(a,b,e,f,g,h)},500);else{this.verbose&&app.debugPrint("RemoteNotificationCenter sendWithWait message sent {0} {1} to {2}\n".format(a,
b,f.instanceId));remoteNotificationCenter.send(a,b,e,f,g)}};window.remoteNotificationCenter=new a;remoteNotificationCenter.addEndpoint(skinWindow);var b=notificationCenter.addInstanceObserver("SkinWindow","Closing",skinWindow,function(){b.release();remoteNotificationCenter.removeEndpoint(skinWindow)})})();
(function(){function a(){this.instanceId=app.expandString("{Guid}");this.settingList={};this.saveFilename=app.expandString("{LocalStorage}")+host.idFromString("{ModuleFilename}")+".settings"}a.prototype={get:function(a){return this.settingList[a]},set:function(a,c,d){isNull(d)&&(d=true);if(!(hasOwnProperty(this.settingList,a)&&d===false)&&this.settingList[a]!==c){d={};d.key=a;d.newValue=c;if(hasOwnProperty(this.settingList,a))d.oldValue=this.settingList[a];this.settingList[a]=c;notificationCenter.fire("Settings",
"DidChange",this,d)}},loadFromObject:function(a){var c;notificationCenter.fire("Settings","WillLoad",this,{});if(!isNull(a))for(c in a)hasOwnProperty(a,c)&&this.set(c,a[c]);notificationCenter.fire("Settings","DidLoad",this,{})},load:function(){var a=this;loadObjectFromFile(this.saveFilename,function(c){a.loadFromObject(c.loadedObject)})},save:function(){saveObjectToFile(this.settingList,this.saveFilename)}};window.settings=new a})();function SkinFileExtract(a){this.instanceId=a}
SkinFileExtract.prototype.release=function(){interop.releaseInstance(this.instanceId)};SkinFileExtract.prototype.getFilename=function(){return interop.invoke(this.instanceId,{method:"getFilename"})};SkinFileExtract.prototype.setFilename=function(a){return interop.invoke(this.instanceId,{method:"setFilename",value:a})};SkinFileExtract.prototype.getOutputFilename=function(){return interop.invoke(this.instanceId,{method:"getOutputFilename"})};
SkinFileExtract.prototype.setOutputFilename=function(a){return interop.invoke(this.instanceId,{method:"setOutputFilename",value:a})};SkinFileExtract.prototype.getBufferSize=function(){return interop.invoke(this.instanceId,{method:"getBufferSize"})};SkinFileExtract.prototype.getCurrentPosition=function(){return interop.invoke(this.instanceId,{method:"getCurrentPosition"})};SkinFileExtract.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};
SkinFileExtract.prototype.getBuffer=function(a,b){return interop.invoke(this.instanceId,{method:"getBuffer",offset:a,length:b})};function createSkinFileExtract(){return interop.createInstance("SSN.SkinFileExtract",SkinFileExtract)}function SkinWindowNotify(){this.INFO=0;this.WARNING=1;this.ERROR=2}var skinWindowNotify=new SkinWindowNotify;function SkinWindowPrompt(){this.UNKNOWN=0;this.OK=1;this.CANCEL=2;this.YES=4;this.NO=8}var skinWindowPrompt=new SkinWindowPrompt;
$(document).ready(function(){function a(){this.instanceId=app.expandString("{Guid}");this.errorElement=this.moveElement=this.closeElement=this.minimizeElement=this.maximizeElement=this.resizeElement=this.rootElement=null;this.autoShow=this.localize=true;this.allowConfirmClose=this.allowSleep=false;this.confirmCloseCancelElement=this.confirmCloseRootElement=null;this.loadTime=0;this.shutdownState=f.WaitForConfirm;this.workflowLoaded=false;this.workflowPath=skinWindow.getConfig("Skin.WorkflowPath",
"")}function b(a,b){if(isNull(h)&&a()===false)b();else{g.push(b);isNull(h)&&(h=setInterval(function(){if(a()!==true){clearInterval(h);h=null;g.forEach(function(a){a()});g=[]}},250))}}var c=null,d=null,e=[],f,g=[],h=null;f={WaitForConfirm:1,WaitForUser:2,WaitForWorkflow:3,Ready:4};a.prototype.onUpdateElement=function(a,b){if(!isNull(a)){var c=a.html();if(c!==b){a.html(b);a.trigger("changed",[c,b])}}};a.prototype.onApplyState=function(a,b){if(a==="skinStateShutdown"){isNull(window.skinWindowView.rootElement)||
c.apply(a);if(!isNull(window.webGetAuthenticateView)){window.webGetAuthenticateView.release();window.webGetAuthenticateView=null}}b===false&&e.length>0?e[0].previousState=a:isNull(window.skinWindowView.rootElement)||c.currentState!=="skinStateShutdown"&&c.apply(a)};a.prototype.error=function(a){this.onUpdateElement(this.errorElement,a);this.onApplyState("skinStateFailure",false)};a.prototype.moveModalToTop=function(a){var b=0,d=this,f,g=false;e.forEach(function(h){if(g===false&&h.name===a){b=e.indexOf(h);
if(b>=0){g=true;if(b+1<e.length){e.splice(b,1);f=e[b].previousState;e[b].previousState=h.previousState;h.previousState=c.currentState;d.onApplyState(f,true);e.push(h)}}}});return g};a.prototype.changeModalState=function(a,b){var c="{0}-{1}".format(b,a.name),d=0,d=e.indexOf(a);if(d+1>=e.length)this.onApplyState(c,true);else e[d+1].previousState=c};a.prototype.showModal=function(a,b,d,f){if(this.moveModalToTop(d)!==true){var g={name:d,element:a,previousState:c.currentState};e.push(g);a.bind("modalMoveToTop.skinwindowview",
null,function(){window.skinWindowView.moveModalToTop(d)});a.bind("modalLoaded.skinwindowview",null,function(){window.skinWindowView.changeModalState(g,"skinStateModalRunning")});a.bind("modalHide.skinwindowview",null,function(){window.skinWindowView.hideModal(d)});if(b===true){window.skinWindowView.changeModalState(g,"skinStateModalLoading");a.trigger("modalLoad",f)}else window.skinWindowView.changeModalState(g,"skinStateModalRunning");a.trigger("modalShow",f)}};a.prototype.hideModal=function(a){var b=
0,d=this;e.forEach(function(f){if(f.name===a){b=e.indexOf(f);if(b>=0){f.element.unbind(".skinwindowview");if(b+1>=e.length){d.onApplyState(e.pop().previousState,true);return true}e.splice(b,1);e[b].previousState=f.previousState;f.previousState=c.currentState;return true}}});return false};a.prototype.localizeElement=function(a){var b,c,d=null,a=isNull(a)?$("*"):a.find("*");a.each(function(){b=$(this).attr("value");d=$(this).data("l18n");if(isNull(d)){if(!isNull(b)&&b.length>0){c=host.getLanguageString(b);
if(b!==c){$(this).attr("value",c);isNull(d)&&(d={});d.value=b}}b=$(this).attr("alt");if(!isNull(b)&&b.length>0){c=host.getLanguageString(b);if(b!==c){$(this).attr("alt",c);isNull(d)&&(d={});d.alt=b}}b=$(this).attr("title");if(!isNull(b)&&b.length>0){c=host.getLanguageString(b);if(b!==c){$(this).attr("title",c);isNull(d)&&(d={});d.title=b}}b=$.trim($(this).html());if(b.length>0){c=host.getLanguageString(b);if(b!==c){$(this).html(c);isNull(d)&&(d={});d.html=b}}if(!isNull(d)){$(this).data("l18n",d);
d=null}}else{hasOwnProperty(d,"value")&&$(this).attr("value",host.getLanguageString(d.value));hasOwnProperty(d,"alt")&&$(this).attr("alt",host.getLanguageString(d.alt));hasOwnProperty(d,"title")&&$(this).attr("title",host.getLanguageString(d.title));hasOwnProperty(d,"html")&&$(this).html(host.getLanguageString(d.html));d=null}});a=document.body.style.display;document.body.style.display="none";document.body.offsetHeight;document.body.style.display=a};a.prototype.relocalize=function(){var a=this;host.loadLanguageByCode(app.getLanguage(),
app.getCountry(),function(b){b.successful===false&&app.debugPrint("Unable to load language strings\n");a.localizeElement();notificationCenter.fire("SkinWindow","L18NComplete",window.skinWindow,{})})};a.prototype.onWorkflowUnloaded=function(){this.workflowLoaded=false;settings.save();host.assert(this.shutdownState===f.WaitForWorkflow,"Invalid shutdown state before final shutdown");this.shutdownState=f.Ready;app.closeAll()};a.prototype.unloadWorkflow=function(){var a=this;host.assert(this.shutdownState===
f.WaitForUser,"Invalid shutdown state before stopWorkflow");if(!isNull(h)){clearInterval(h);h=null}g=[];this.shutdownState=f.WaitForWorkflow;this.workflowLoaded===true?workflow.unload():setTimeout(function(){a.onWorkflowUnloaded()},0)};window.skinWindowView=new a;notificationCenter.fire("SkinWindowView","Bind",window.skinWindowView,window.skinWindowView);if(!isNull(window.skinWindowView.rootElement)){c=new ChangeClass(window.skinWindowView.rootElement);window.skinWindowView.onApplyState("skinStateInitializing",
false);window.skinWindowView.rootElement.bind("changed",null,function(){window.skinWindowView.allowSleep!==true&&platform.resetSystemIdleTimer()})}isNull(window.skinWindowView.resizeElement)||window.skinWindowView.resizeElement.mousedown(function(a){a.which===1&&skinWindow.beginSize()});isNull(window.skinWindowView.moveElement)||window.skinWindowView.moveElement.mousedown(function(a){a.which===1&&skinWindow.beginMove()});isNull(window.skinWindowView.closeElement)||window.skinWindowView.closeElement.click(function(){skinWindow.close()});
isNull(window.skinWindowView.minimizeElement)||window.skinWindowView.minimizeElement.click(function(){skinWindow.minimize()});if(!isNull(window.skinWindowView.confirmCloseRootElement)){var i={onComplete:function(){window.skinWindowView.shutdownState=f.WaitForUser;window.skinWindow.close()}};window.skinWindowView.confirmCloseRootElement.find("form").submit(function(){window.skinWindowView.confirmCloseRootElement.trigger("modalSuccess",i);window.skinWindowView.hideModal("confirmClose");if(hasOwnProperty(i,
"onComplete")&&!isNull(i.onComplete))i.onComplete();return false});isNull(window.skinWindowView.confirmCloseCancelElement)||window.skinWindowView.confirmCloseCancelElement.click(function(){window.skinWindowView.confirmCloseRootElement.trigger("modalFailure");window.skinWindowView.hideModal("confirmClose")})}notificationCenter.addInstanceObserver("Settings","DidLoad",settings,function(){settings.set("logExpirationDays",parseInt(app.getConfig("DefaultLogExpirationDays","0"),10),false);settings.set("maxFileWriteRate",
parseInt(app.getConfig("DefaultFileWriteRate","0"),10),false);settings.set("maxFileReadRate",parseInt(app.getConfig("DefaultFileReadRate","0"),10),false);settings.set("maxUploadRate",parseInt(app.getConfig("DefaultUploadRate","0"),10),false);settings.set("maxDownloadRate",parseInt(app.getConfig("DefaultDownloadRate","0"),10),false);settings.set("webEnabled",app.getConfig("DefaultWeb","true").toBoolean(),false);settings.set("p2pEnabled",app.getConfig("DefaultP2P","true").toBoolean(),false)});notificationCenter.addInstanceObserver("Workflow",
"DidLoad",workflow,function(){window.skinWindowView.onApplyState("skinStateRunning",false)});notificationCenter.addInstanceObserver("Workflow","WillUnload",workflow,function(){window.skinWindowView.onApplyState("skinStateShutdown",false)});notificationCenter.addInstanceObserver("Workflow","DidUnload",workflow,function(){window.skinWindowView.onWorkflowUnloaded()});notificationCenter.addInstanceObserver("SkinWindow","DidClose",skinWindow,function(){isNull(window.skinWindowView.rootElement)||window.skinWindowView.rootElement.trigger("didClose");
isNull(window.skinWindowView.resizeElement)||window.skinWindowView.resizeElement.unbind();isNull(window.skinWindowView.moveElement)||window.skinWindowView.moveElement.unbind();isNull(window.skinWindowView.closeElement)||window.skinWindowView.closeElement.unbind();isNull(window.skinWindowView.minimizeElement)||window.skinWindowView.minimizeElement.unbind();window.skinWindowView=null});notificationCenter.addInstanceObserver("SkinWindow","WillClose",skinWindow,function(a,b){if(b.canClose!==false){if(window.skinWindowView.shutdownState===
f.WaitForConfirm)app.getRestart()===false&&window.skinWindowView.allowConfirmClose===true&&!isNull(window.skinWindowView.confirmCloseRootElement)?window.skinWindowView.showModal(window.skinWindowView.confirmCloseRootElement,false,"confirmClose",{}):window.skinWindowView.shutdownState=f.WaitForUser;if(window.skinWindowView.shutdownState===f.WaitForUser){isNull(window.skinWindowView.rootElement)||window.skinWindowView.rootElement.trigger("willClose",[b]);b.canClose===true&&window.skinWindowView.unloadWorkflow()}if(window.skinWindowView.shutdownState!==
f.Ready)b.canClose=false}});notificationCenter.addInstanceObserver("SkinWindow","L18NComplete",skinWindow,function(){isNull(window.skinWindowView.rootElement)||window.skinWindowView.rootElement.trigger("localize",[app.getLanguage(),app.getCountry()])});d=notificationCenter.addInstanceObserver("SkinWindow","L18NComplete",skinWindow,function(){d.release();skinWindow.setTitle(host.getLanguageString(skinWindow.getTitle()));window.skinWindowView.loadTime=app.getCurrentTime()-app.getStartTime();window.skinWindowView.autoShow===
true&&skinWindow.show()});remoteNotificationCenter.addInstanceObserver("SkinWindow","SettingChange",skinWindow,function(a,b,c){settings.set(c.key,c.value)});notificationCenter.addInstanceObserver("Settings","DidChange",settings,function(a,c){function d(){return isNull(window.downloader)}switch(c.key){case "language":var e=c.newValue.split("-");if(e.length>1){app.setLanguage(e[0]);app.setCountry(e[1]);window.skinWindowView.relocalize()}break;case "webEnabled":b(d,function(){window.downloader.setWebBaseActive(c.newValue)});
break;case "p2pEnabled":b(d,function(){window.downloader.setBitBaseActive(c.newValue)});break;case "maxUploadRate":b(d,function(){window.downloader.setUploadLimit(c.newValue)});break;case "maxDownloadRate":b(d,function(){window.downloader.setDownloadLimit(c.newValue)});break;case "maxFileReadRate":window.platform.setFileReadLimit(c.newValue);break;case "maxFileWriteRate":window.platform.setFileWriteLimit(c.newValue);break;case "logExpirationDays":app.setLogExpirationDays(c.newValue)}});window.skinWindowView.localize===
true?window.skinWindowView.relocalize():notificationCenter.fire("SkinWindow","L18NComplete",window.skinWindow,{});if(!isNull(window.skinWindowView.workflowPath)){window.skinWindowView.workflowLoaded=true;window.workflow.load(window.skinWindowView.workflowPath)}settings.load()});function SystemMutex(a){this.instanceId=a}SystemMutex.prototype.release=function(){interop.releaseInstance(this.instanceId)};SystemMutex.prototype.getName=function(){return interop.invoke(this.instanceId,{method:"getName"})};
SystemMutex.prototype.setName=function(a){return interop.invoke(this.instanceId,{method:"setName",value:a})};SystemMutex.prototype.lock=function(){return interop.invoke(this.instanceId,{method:"lock"})};SystemMutex.prototype.lockWithTimeout=function(a){return interop.invoke(this.instanceId,{method:"lockWithTimeout",waitMS:a})};SystemMutex.prototype.unlock=function(){return interop.invoke(this.instanceId,{method:"unlock"})};
function createSystemMutex(){return interop.createInstance("SSN.SystemMutex",SystemMutex)}function TaskController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}TaskController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
TaskController.prototype.onStart=function(a){a.assertArgument("message");switch(a.args.type){case "taskWarning":a.warning(a.args.message);break;case "taskError":a.error(a.args.message);break;default:host.assert(false,"Unknown type in TaskController ({0})".format(a.args.type))}a.complete()};registerTaskController("taskWarning",TaskController);registerTaskController("taskError",TaskController);function TextFileReader(a){this.instanceId=a}TextFileReader.prototype.release=function(){interop.releaseInstance(this.instanceId)};
TextFileReader.prototype.getBufferSize=function(){return interop.invoke(this.instanceId,{method:"getBufferSize"})};TextFileReader.prototype.setBufferSize=function(a){return interop.invoke(this.instanceId,{method:"setBufferSize",value:a})};TextFileReader.prototype.getFileName=function(){return interop.invoke(this.instanceId,{method:"getFileName"})};TextFileReader.prototype.setFileName=function(a){return interop.invoke(this.instanceId,{method:"setFileName",value:a})};
TextFileReader.prototype.getFileSize=function(){return interop.invoke(this.instanceId,{method:"getFileSize"})};TextFileReader.prototype.getBytesLeft=function(){return interop.invoke(this.instanceId,{method:"getBytesLeft"})};TextFileReader.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};function createTextFileReader(){return interop.createInstance("SSN.TextFileReader",TextFileReader)}function TextFileWriter(a){this.instanceId=a}TextFileWriter.prototype.release=function(){interop.releaseInstance(this.instanceId)};
TextFileWriter.prototype.open=function(a){return interop.invoke(this.instanceId,{method:"open",fileName:a})};TextFileWriter.prototype.write=function(a){return interop.invoke(this.instanceId,{method:"write",value:a})};TextFileWriter.prototype.close=function(){return interop.invoke(this.instanceId,{method:"close"})};function createTextFileWriter(){return interop.createInstance("SSN.TextFileWriter",TextFileWriter)}
function UIModalController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.cancelBehavior="error"}UIModalController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};UIModalController.prototype.onStart=function(a){if(hasOwnProperty(a.args,"cancelBehavior"))this.cancelBehavior=a.args.cancelBehavior};
UIModalController.prototype.ok=function(a){notificationCenter.fire("Task","HideModal",a,{result:"ok"});a.runSubAction("ok",null,function(){a.complete()})};UIModalController.prototype.cancel=function(a){notificationCenter.fire("Task","HideModal",a,{result:"cancel"});switch(this.cancelBehavior.toLowerCase()){case "none":break;case "warning":a.warning("UI_UserAbort");break;default:a.error("UI_UserAbort")}a.runSubAction("cancel",null,function(){a.complete()})};registerTaskController("uimodal",UIModalController);
function UIModalView(a){var b=this;this.element=null;this.isVisible=this.requireValidation=this.requireLoad=false;this.cancelElement=null;this.controller=a.controller;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","Complete",a,function(c,d){b.onComplete(a,d)}));this.observers.push(notificationCenter.addInstanceObserver("Task","HideModal",a,function(c,d){b.onWindowHideModal(a,
d)}));this.observers.push(notificationCenter.addInstanceObserver("Workflow","WillUnload",workflow,function(c,d){b.onWorkflowUnload(a,d)}))}UIModalView.prototype.release=function(){if(!isNull(this.controller)){this.controller.release();this.controller=null}this.observers.forEach(function(a){a.release()});this.observers=[]};
UIModalView.prototype.onShow=function(a){host.assert(this.isVisible===false,"Trying to show an already visible view");window.skinWindowView.showModal(this.element,this.requireLoad,a.name,a);this.isVisible=true};UIModalView.prototype.onHide=function(a){if(this.isVisible!==false){this.isVisible=false;window.skinWindowView.hideModal(a.name)}};
UIModalView.prototype.onStart=function(a){var b=this;this.element=$(a.args.element);host.assert(!isNull(this.element),"Element not found for {0}".format(a.name));this.cancelElement=this.element.find(a.args.cancelElement);this.element.trigger("bind",[a,this]);this.element.unbind(".uimodalview");this.element.find("form").unbind(".uimodalview");isNull(this.cancelElement)||this.cancelElement.unbind(".uimodalview");this.element.find("form").bind("submit.uimodalview",null,function(){b.requireValidation===
true?b.element.trigger("modalValidate",a):b.element.trigger("modalSuccess");return false});this.element.bind("modalSuccess.uimodalview",null,function(){a.controller.ok(a)});this.element.bind("modalFailure.uimodalview",null,function(){a.controller.cancel(a)});isNull(this.cancelElement)||this.cancelElement.bind("click.uimodalview",null,function(){b.element.trigger("modalFailure")});this.onShow(a)};UIModalView.prototype.onComplete=function(){this.release()};UIModalView.prototype.onWindowHideModal=function(a){this.onHide(a)};
UIModalView.prototype.onWorkflowUnload=function(){this.release()};registerTaskView("uimodal",UIModalView);function UnloadInteropController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}));this.observers.push(notificationCenter.addObserver("App","InteropUnloaded",function(c,d){b.onInteropUnloaded(a,d)}))}
UnloadInteropController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};UnloadInteropController.prototype.onInteropUnloaded=function(a,b){var c={},d;d=app.expandString(a.args.filename);if(b.fileName.toLowerCase()===d.toLowerCase()){if(b.successful===true){window.interop.activeInteropLibs.removeElement(a.args.name);mergeObjectProperties(c,a.args);notificationCenter.fire("Interop","DidUnload",a,c)}else a.error("Interop_UnloadFailed");a.complete()}};
UnloadInteropController.prototype.onStart=function(a){var b={},c;a.assertArgument("name");a.assertArgument("filename");c=app.expandString(a.args.filename);mergeObjectProperties(b,a.args);b.cancel=false;notificationCenter.fire("Interop","WillUnload",a,b);if(b.cancel===true){app.debugPrint("Interop unload cancelled ({0})".format(a.args.name));a.error("Interop_UnloadCancel");a.complete()}else if(app.unloadInterop(c)===false){b={};mergeObjectProperties(b,a.args);notificationCenter.fire("Interop","DidUnload",
a,b);a.complete()}};registerTaskController("unloadInterop",UnloadInteropController);function UrlRedirectController(a){var b=this;this.observers=[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,d){b.onStart(a,d)}))}UrlRedirectController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[]};
UrlRedirectController.prototype.checkMatch=function(a,b){var c=false;switch(getObjectType(a.args.beginsWith)){case "array":a.args.beginsWith.forEach(function(a){b.beginsWith(app.expandString(a))&&(c=true)});break;default:b.beginsWith(app.expandString(a.args.beginsWith))&&(c=true)}return c};
UrlRedirectController.prototype.onStart=function(a){var b=this;a.assertArgument("beginsWith");host.assert(hasOwnProperty(a.args,"append")||hasOwnProperty(a.args,"replace"),"{0} not defined for ({1}) in ({2})".format("append/replace",a.type,a.name));notificationCenter.addObserver("App","WillConstructWebGetTarget",function(c,d){if(b.checkMatch(a,d.url))if(isNull(a.args.append)){if(!isNull(a.args.replace))d.url=app.expandString(a.args.replace)}else d.url=app.expandString(d.url+a.args.append)});a.complete()};
registerTaskController("urlRedirect",UrlRedirectController);
$(document).ready(function(){function a(){this.instanceId=app.expandString("{Guid}");this.cancelElement=this.passwordElement=this.usernameElement=this.realmElement=this.portElement=this.serverElement=this.errorElement=this.rootElement=null;this.observers=[]}var b={};a.prototype.cancelAll=function(){$.each(b,function(a,b){$.each(b,function(a,b){window.downloader.webGetRetryAuth(b.webGetContextId,true)})});isNull(window.webGetAuthenticateView.rootElement)||window.webGetAuthenticateView.rootElement.removeData("webAuthInfo");
b={}};a.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];this.cancelAll();window.webGetAuthenticateView=null;notificationCenter.addObserver("App","WillAuthenticateWebGet",function(a,b){window.downloader.webGetRetryAuth(b.webGetContextId,true)})};window.webGetAuthenticateView=new a;notificationCenter.fire("WebGetAuthenticateView","Bind",window.webGetAuthenticateView,window.webGetAuthenticateView);if(isNull(window.webGetAuthenticateView.rootElement)&&isNull(window.webGetAuthenticateView.serverElement)&&
isNull(window.webGetAuthenticateView.portElement)&&isNull(window.webGetAuthenticateView.realmElement)&&isNull(window.webGetAuthenticateView.usernameElement)&&isNull(window.webGetAuthenticateView.passwordElement))window.webGetAuthenticateView.release();else{window.webGetAuthenticateView.observers.push(notificationCenter.addObserver("App","WillAuthenticateWebGet",function(a,d){var e="{0}#{1}".format(d.host,d.realm);if(hasOwnProperty(b,e)){isNull(window.webGetAuthenticateView.rootElement)||window.skinWindowView.moveModalToTop("webAuthenticate");
b[e].push(d)}else if(!isNull(window.webGetAuthenticateView.rootElement)){b[e]=[d];window.skinWindowView.showModal(window.webGetAuthenticateView.rootElement,false,"webAuthenticate",d)}}));if(!isNull(window.webGetAuthenticateView.rootElement)){window.webGetAuthenticateView.rootElement.bind("modalShow",function(a,b){var e,f,g,h="";window.webGetAuthenticateView.rootElement.data("webAuthInfo",b);if(b.host.indexOf(":")!==-1){e=b.host.substr(b.host.indexOf(":")+1);f=b.host.substr(0,b.host.indexOf(":"))}else{e=
"80";f=b.host}g={username:"",password:""};isNull(window.webGetAuthenticateView.serverElement)||window.webGetAuthenticateView.serverElement.html(f);isNull(window.webGetAuthenticateView.portElement)||window.webGetAuthenticateView.portElement.html(e);isNull(window.webGetAuthenticateView.realmElement)||window.webGetAuthenticateView.realmElement.html(b.realm);if(app.getWebCredential(b.type,b.host,b.realm,g)===true){if(!isNull(window.webGetAuthenticateView.errorElement)){e=window.webGetAuthenticateView.errorElement.html();
h=host.getLanguageString("WebAuthenticate_InvalidLogin");window.webGetAuthenticateView.errorElement.html(h);window.webGetAuthenticateView.errorElement.trigger("changed",[e,h])}isNull(window.webGetAuthenticateView.usernameElement)||window.webGetAuthenticateView.usernameElement.val(g.username);isNull(window.webGetAuthenticateView.passwordElement)||window.webGetAuthenticateView.passwordElement.val(g.password)}else{if(!isNull(window.webGetAuthenticateView.errorElement)){e=window.webGetAuthenticateView.errorElement.html();
window.webGetAuthenticateView.errorElement.html(h);window.webGetAuthenticateView.errorElement.trigger("changed",[e,h])}isNull(window.webGetAuthenticateView.usernameElement)||window.webGetAuthenticateView.usernameElement.val("");isNull(window.webGetAuthenticateView.passwordElement)||window.webGetAuthenticateView.passwordElement.val("")}});window.webGetAuthenticateView.rootElement.find("form").submit(function(){var a=window.webGetAuthenticateView.rootElement.data("webAuthInfo");if(!isNull(a)){!isNull(window.webGetAuthenticateView.usernameElement)&&
!isNull(window.webGetAuthenticateView.passwordElement)&&app.setWebCredential(a.type,a.host,a.realm,window.webGetAuthenticateView.usernameElement.val(),window.webGetAuthenticateView.passwordElement.val());a="{0}#{1}".format(a.host,a.realm);$.each(b[a],function(a,b){window.downloader.webGetRetryAuth(b.webGetContextId,false)});delete b[a]}window.webGetAuthenticateView.rootElement.removeData("webAuthInfo");window.skinWindowView.hideModal("webAuthenticate");return false})}isNull(window.webGetAuthenticateView.cancelElement)||
window.webGetAuthenticateView.cancelElement.click(function(){if(!isNull(window.webGetAuthenticateView.rootElement)){var a=window.webGetAuthenticateView.rootElement.data("webAuthInfo"),d;d="{0}#{1}".format(a.host,a.realm);if(!isNull(a)){$.each(b[d],function(a,b){window.downloader.webGetRetryAuth(b.webGetContextId,true)});delete b[d]}window.webGetAuthenticateView.rootElement.removeData("webAuthInfo");window.skinWindowView.hideModal("webAuthenticate")}})}});
(function(){function a(){this.instanceId=app.expandString("{Guid}");this.tasks=new Tasks;this.isLoading=false;this.isComplete=true}a.prototype.runTask=function(a,c){var d,e;d=this.tasks.create(a,false,window.taskControllerCreator,window.taskViewCreator);if(isNull(d))setTimeout(function(){c(d,{})},0);else{e=notificationCenter.addInstanceObserver("Task","Complete",d,function(a,b){e.release();c(d,b)});d.start()}};a.prototype.onLoaded=function(a){var c=this,d="start";if(a.successful===false){c.isLoading=
false;skinWindowView.error("Workflow_LoadFail")}else this.runTask("load",function(a){c.isLoading=false;notificationCenter.fire("Workflow","DidLoad",c,{});if(!isNull(a)&&a.hasError())window.skinWindowView.error(a.getFirstErrorMessage());else{c.isComplete=false;app.isCommandFieldSet("uninstall")===true&&c.tasks.exists("uninstall")===true&&(d="uninstall");app.debugPrint("Worflow starting from {0}\n".format(d));c.runTask(d,function(a){!isNull(a)&&a.hasError()&&window.skinWindowView.error(a.getFirstErrorMessage());
c.isComplete=true})}})};a.prototype.load=function(a){var c=this;this.isLoading=true;notificationCenter.fire("Workflow","WillLoad",this,{});this.tasks.load(a,function(a){c.onLoaded(a)})};a.prototype.unload=function(){var a=this;if(this.isLoading===true)setTimeout(function(){a.unload()},100);else{this.tasks.cancelAll();if(this.isComplete===false)setTimeout(function(){a.unload()},100);else{notificationCenter.fire("Workflow","WillUnload",a,{});this.runTask("unload",function(){notificationCenter.fire("Workflow",
"DidUnload",a,{})})}}};window.workflow=new a})();
