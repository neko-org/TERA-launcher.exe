/*
 Modifications performed to this file by anyone other than Solid State Networks
 are unsupported and may void your software warranty.
*/
$(document).ready(function(){host.assert("3.6.8.1"===app.expandString("{AppVersion}"),"Invalid application version")});function Download(a){this.instanceId=a}Download.prototype.release=function(){interop.releaseInstance(this.instanceId)};Download.prototype.getIdentifier=function(){return interop.invoke(this.instanceId,{method:"getIdentifier"})};Download.prototype.getMetafileSource=function(){return interop.invoke(this.instanceId,{method:"getMetafileSource"})};
Download.prototype.setMetafileSource=function(a){return interop.invoke(this.instanceId,{method:"setMetafileSource",value:a})};Download.prototype.getUrl=function(){return interop.invoke(this.instanceId,{method:"getUrl"})};Download.prototype.setUrl=function(a){return interop.invoke(this.instanceId,{method:"setUrl",value:a})};Download.prototype.getActive=function(){return interop.invoke(this.instanceId,{method:"getActive"})};
Download.prototype.setActive=function(a){return interop.invoke(this.instanceId,{method:"setActive",value:a})};Download.prototype.getAllowSeeding=function(){return interop.invoke(this.instanceId,{method:"getAllowSeeding"})};Download.prototype.getUploadLimit=function(){return interop.invoke(this.instanceId,{method:"getUploadLimit"})};Download.prototype.setUploadLimit=function(a){return interop.invoke(this.instanceId,{method:"setUploadLimit",value:a})};
Download.prototype.getDownloadLimit=function(){return interop.invoke(this.instanceId,{method:"getDownloadLimit"})};Download.prototype.setDownloadLimit=function(a){return interop.invoke(this.instanceId,{method:"setDownloadLimit",value:a})};Download.prototype.getWebUploadLimit=function(){return interop.invoke(this.instanceId,{method:"getWebUploadLimit"})};Download.prototype.setWebUploadLimit=function(a){return interop.invoke(this.instanceId,{method:"setWebUploadLimit",value:a})};
Download.prototype.getWebDownloadLimit=function(){return interop.invoke(this.instanceId,{method:"getWebDownloadLimit"})};Download.prototype.setWebDownloadLimit=function(a){return interop.invoke(this.instanceId,{method:"setWebDownloadLimit",value:a})};Download.prototype.getBitUploadLimit=function(){return interop.invoke(this.instanceId,{method:"getBitUploadLimit"})};Download.prototype.setBitUploadLimit=function(a){return interop.invoke(this.instanceId,{method:"setBitUploadLimit",value:a})};
Download.prototype.getBitDownloadLimit=function(){return interop.invoke(this.instanceId,{method:"getBitDownloadLimit"})};Download.prototype.setBitDownloadLimit=function(a){return interop.invoke(this.instanceId,{method:"setBitDownloadLimit",value:a})};Download.prototype.getStallReason=function(){return interop.invoke(this.instanceId,{method:"getStallReason"})};Download.prototype.getCompleted=function(){return interop.invoke(this.instanceId,{method:"getCompleted"})};
Download.prototype.getIsRunning=function(){return interop.invoke(this.instanceId,{method:"getIsRunning"})};Download.prototype.getMaskEnabled=function(){return interop.invoke(this.instanceId,{method:"getMaskEnabled"})};Download.prototype.setMaskEnabled=function(a){return interop.invoke(this.instanceId,{method:"setMaskEnabled",value:a})};Download.prototype.getAccessible=function(){return interop.invoke(this.instanceId,{method:"getAccessible"})};
Download.prototype.getState=function(){return interop.invoke(this.instanceId,{method:"getState"})};Download.prototype.getSessionState=function(){return interop.invoke(this.instanceId,{method:"getSessionState"})};Download.prototype.getSessionTimeElapsed=function(){return interop.invoke(this.instanceId,{method:"getSessionTimeElapsed"})};Download.prototype.getTransferTotal=function(){return interop.invoke(this.instanceId,{method:"getTransferTotal"})};
Download.prototype.getTransferRates=function(){return interop.invoke(this.instanceId,{method:"getTransferRates"})};Download.prototype.getTotalBytes=function(){return interop.invoke(this.instanceId,{method:"getTotalBytes"})};Download.prototype.getBytesLeft=function(){return interop.invoke(this.instanceId,{method:"getBytesLeft"})};Download.prototype.getRemainingTime=function(){return interop.invoke(this.instanceId,{method:"getRemainingTime"})};
Download.prototype.getStateProgress=function(){return interop.invoke(this.instanceId,{method:"getStateProgress"})};Download.prototype.getLastError=function(){return interop.invoke(this.instanceId,{method:"getLastError"})};Download.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};Download.prototype.stop=function(){return interop.invoke(this.instanceId,{method:"stop"})};
Download.prototype.expandString=function(a){return interop.invoke(this.instanceId,{method:"expandString",expand:a})};Download.prototype.clearMetafileBuffer=function(){return interop.invoke(this.instanceId,{method:"clearMetafileBuffer"})};Download.prototype.appendMetafileBuffer=function(a){return interop.invoke(this.instanceId,{method:"appendMetafileBuffer",metafileData:a})};Download.prototype.maskFile=function(a){return interop.invoke(this.instanceId,{method:"maskFile",fileName:a})};
Download.prototype.maskFileRange=function(a,b,c){return interop.invoke(this.instanceId,{method:"maskFileRange",fileName:a,offset:b,length:c})};Download.prototype.syncToMask=function(){return interop.invoke(this.instanceId,{method:"syncToMask"})};Download.prototype.resetOptions=function(){return interop.invoke(this.instanceId,{method:"resetOptions"})};Download.prototype.allowEvent=function(a){return interop.invoke(this.instanceId,{method:"allowEvent",type:a})};
Download.prototype.denyEvent=function(a){return interop.invoke(this.instanceId,{method:"denyEvent",type:a})};Download.prototype.getOptionString=function(a){return interop.invoke(this.instanceId,{method:"getOptionString",name:a})};Download.prototype.setOptionString=function(a,b){return interop.invoke(this.instanceId,{method:"setOptionString",name:a,value:b})};Download.prototype.getOptionInt32=function(a){return interop.invoke(this.instanceId,{method:"getOptionInt32",name:a})};
Download.prototype.setOptionInt32=function(a,b){return interop.invoke(this.instanceId,{method:"setOptionInt32",name:a,value:b})};Download.prototype.getOptionBoolean=function(a){return interop.invoke(this.instanceId,{method:"getOptionBoolean",name:a})};Download.prototype.setOptionBoolean=function(a,b){return interop.invoke(this.instanceId,{method:"setOptionBoolean",name:a,value:b})};function createDownload(){return interop.createInstance("SSN.Download",Download)}
function DownloadController(a,b,c){var d=this;this.observers=[];isNull(c)?(this.ownsDownload=!0,this.download=createDownload()):(this.ownsDownload=!1,this.download=c);this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,b){d.onStart(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Task","Complete",a,function(c,b){d.onComplete(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Download","Complete",this.download,function(c,b){d.onDownloadComplete(a,
b)}));this.observers.push(notificationCenter.addInstanceObserver("Download","ConfigComplete",this.download,function(c,b){d.onDownloadConfigComplete(a,b)}))}DownloadController.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];this.download.stop();isNull(this.download)||(!0===this.ownsDownload&&this.download.release(),this.download=null)};
DownloadController.prototype.onStart=function(a){var b,c,d=0,e=this;if(hasOwnProperty(a.args,"metafile"))this.download.setMetafileSource(app.expandString(a.args.metafile)),this.download.setUrl("");else if(hasOwnProperty(a.args,"metafileData")){this.download.setUrl("");this.download.setMetafileSource("");for(c="array"==getObjectType(a.args.metafileData)?a.args.metafileData.join(""):a.args.metafileData;d<c.length;)this.download.appendMetafileBuffer(c.substring(d,d+8E3)),d+=8E3}else hasOwnProperty(a.args,
"url")?(this.download.setMetafileSource(""),this.download.setUrl(app.expandString(a.args.url))):host.assert(!1,"{0} not defined for ({1}) in ({2})".format("url/metafile/metafileData",a.type,a.name));hasOwnProperty(a.args,"allowEvents")&&"function"===getObjectType(a.args.allowEvents.forEach)&&a.args.allowEvents.forEach(function(a){e.download.allowEvent(a)});if(hasOwnProperty(a.args,"config"))for(b in a.args.config)if(hasOwnProperty(a.args.config,b))switch(c=a.args.config[b],getObjectType(c)){case "string":this.download.setOptionString(b,
app.expandString(c));break;case "number":this.download.setOptionInt32(b,c);break;case "boolean":this.download.setOptionBoolean(b,c);break;default:host.app.debugPrint("Unable to set property {0} on download (unknown type)\n".format(b))}this.download.start()};DownloadController.prototype.onComplete=function(a){hasOwnProperty(a.args,"retain")&&!1===a.args.retain&&this.download.stop()};DownloadController.prototype.onDownloadConfigComplete=function(){this.download.setActive(!0)};
DownloadController.prototype.onDownloadComplete=function(a,b){!1===b.successful?(a.error("DownloadError_"+downloadError.nameFromId(this.download.getLastError())),a.complete()):isNull(a.args.autolaunch)?a.complete():(notificationCenter.fire("DownloadTask","Launch",a,{}),a.runSubAction("autolaunch",null,function(c,b){b.launchTask=c;notificationCenter.fire("DownloadTask","LaunchComplete",a,b);a.complete()}))};
DownloadController.prototype.launch=function(a){isNull(a.args.launch)||(notificationCenter.fire("DownloadTask","Launch",a,{}),a.runSubAction("launch",null,function(b,c){c.launchTask=b;notificationCenter.fire("DownloadTask","LaunchComplete",a,c)}))};DownloadController.prototype.getDownload=function(){return this.download};registerTaskController("download",DownloadController);
(function(){var a,b;a=notificationCenter.addObserver("Interop","DidLoad",function(c,d){function e(a){this.instanceId=a}"downloader"===d.name&&(a.release(),e.prototype.release=function(){interop.releaseInstance(this.instanceId)},e.prototype.getActive=function(){return interop.invoke(this.instanceId,{method:"getActive"})},e.prototype.setActive=function(a){return interop.invoke(this.instanceId,{method:"setActive",value:a})},e.prototype.getWebBaseActive=function(){return interop.invoke(this.instanceId,
{method:"getWebBaseActive"})},e.prototype.setWebBaseActive=function(a){return interop.invoke(this.instanceId,{method:"setWebBaseActive",value:a})},e.prototype.getBitBaseActive=function(){return interop.invoke(this.instanceId,{method:"getBitBaseActive"})},e.prototype.setBitBaseActive=function(a){return interop.invoke(this.instanceId,{method:"setBitBaseActive",value:a})},e.prototype.getDownloadingCount=function(){return interop.invoke(this.instanceId,{method:"getDownloadingCount"})},e.prototype.getUploadLimit=
function(){return interop.invoke(this.instanceId,{method:"getUploadLimit"})},e.prototype.setUploadLimit=function(a){return interop.invoke(this.instanceId,{method:"setUploadLimit",value:a})},e.prototype.getDownloadLimit=function(){return interop.invoke(this.instanceId,{method:"getDownloadLimit"})},e.prototype.setDownloadLimit=function(a){return interop.invoke(this.instanceId,{method:"setDownloadLimit",value:a})},e.prototype.getTransferRates=function(){return interop.invoke(this.instanceId,{method:"getTransferRates"})},
e.prototype.webGetRetryAuth=function(a,c){return interop.invoke(this.instanceId,{method:"webGetRetryAuth",webGetContextId:a,cancel:c})},window.downloader=interop.createInstance("SSN.Downloader",e),b=notificationCenter.addObserver("Interop","WillUnload",function(a,c){"downloader"===c.name&&(b.release(),window.downloader.release(),window.downloader=null)}))})})();
function DownloadError(){this.NONE=0;this.UNKNOWN=1;this.INVALIDMETAFILE=2;this.ALREADYDOWNLOADING=3;this.NOTENOUGHSPACE=4;this.UNACCEPTABLESOURCE=5;this.INVALIDSOURCE=6;this.DOWNLOADFAILED=7;this.USERABORT=8}DownloadError.prototype.nameFromId=function(a){return"None Unknown InvalidMetafile AlreadyDownloading NotEnoughSpace UnacceptableSource InvalidSource DownloadFailed UserAbort".split(" ")[a]};var downloadError=new DownloadError;
function DownloadEvent(){this.DISKWRITE=0;this.DISKREAD=1;this.DISKFLUSH=2;this.DISKCLOSE=3;this.WEBREQUEST=4;this.WEBFIRSTBYTE=5;this.PEERCONNECT=6;this.PEERENCRYPT=7;this.PEERFIRSTBYTE=8}DownloadEvent.prototype.nameFromId=function(a){return"DiskWrite DiskRead DiskFlush DiskClose WebRequest WebFirstByte PeerConnect PeerEncrypt PeerFirstByte".split(" ")[a]};var downloadEvent=new DownloadEvent;
function DownloadSessionStateFlag(){this.NONE=0;this.P2P=1;this.HTTP=2;this.UPNP=4;this.NATPMP=8;this.STUN=16;this.STUN_UDPBLOCKED=32;this.STUN_OPENINTERNET=64;this.STUN_SYMMETRICFIREWALL=128;this.STUN_FULLCONENAT=256;this.STUN_SYMMETRICCONENAT=512;this.STUN_RESTRICTEDCONENAT=1024;this.STUN_PORTRESTRICTEDCONENAT=2048;this.PROXY=4096;this.PROXY_BASIC=8192;this.PROXY_DIGEST=16384;this.PROXY_NTLM=32768;this.PROXY_NEGOTIATE=65536;this.P2P_HASSEEDS=131072;this.P2P_HASINCOMING=this.P2P_HASLEECHES=262144}
DownloadSessionStateFlag.prototype.connectivityFromId=function(a,b){if(0>a)return"Unknown";if(a==downloadSessionStateFlag.NONE)return"None";var c="";thisIs(a,downloadSessionStateFlag.P2P)&&(c+="P2P_");thisIs(a,downloadSessionStateFlag.HTTP)&&(c+="HTTP_");if(!0==b&&(thisIs(a,downloadSessionStateFlag.UPNP)&&(c+="UPNP_"),thisIs(a,downloadSessionStateFlag.NATPMP)&&(c+="NATPMP_"),thisIs(a,downloadSessionStateFlag.STUN)&&(c+="Stun",thisIs(a,downloadSessionStateFlag.STUN_UDPBLOCKED)?c+="UDPBlocked_":thisIs(a,
downloadSessionStateFlag.STUN_OPENINTERNET)?c+="OpenInternet_":thisIs(a,downloadSessionStateFlag.STUN_SYMMETRICFIREWALL)?c+="SymmetricFirewall_":thisIs(a,downloadSessionStateFlag.STUN_FULLCONENAT)?c+="FullConeNAT_":thisIs(a,downloadSessionStateFlag.STUN_SYMMETRICCONENAT)?c+="SymmetricConeNAT_":thisIs(a,downloadSessionStateFlag.STUN_RESTRICTEDCONENAT)?c+="RestrictedConeNAT_":thisIs(a,downloadSessionStateFlag.STUN_PORTRESTRICTEDCONENAT)&&(c+="PortRestrictedConeNAT_")),thisIs(a,downloadSessionStateFlag.PROXY)))c+=
"Proxy",thisIs(a,downloadSessionStateFlag.PROXY_BASIC)?c+="Basic":thisIs(a,downloadSessionStateFlag.PROXY_DIGEST)?c+="Digest":thisIs(a,downloadSessionStateFlag.PROXY_NTLM)?c+="NTLM":thisIs(a,downloadSessionStateFlag.PROXY_NEGOTIATE)&&(c+="Negotiate");return c=c.trimChars("_")};var downloadSessionStateFlag=new DownloadSessionStateFlag;
function DownloadStallReason(){this.NONE=0;this.RELIABLESOURCECANTCONTACT=1;this.RELIABLESOURCEBADINTEGRITY=2;this.RELIABLESOURCENOTSPECIFIED=3;this.TRACKERNOTSPECIFIED=4;this.TRACKERLISTEMPTY=5;this.TRACKERCANTCONTACT=6;this.PEERLISTEMPTY=7;this.PEERNOGOODONES=8;this.CONTENTWRITE=9;this.TRANSPORTHTTP=10;this.TRANSPORTHTTPCLIENT=11;this.TRANSPORTSOCKET=12}DownloadStallReason.prototype.nameFromId=function(a){return"None ReliableSourceContact ReliableSourceBadIntegrity ReliableSourceNotSpecified TrackerNotSpecified TrackerListEmpty TrackerContact PeerListEmpty PeerNoGoodOnes ContentWrite TransportHttp TransportHttpClient TransportSocket".split(" ")[a]};
var downloadStallReason=new DownloadStallReason;function DownloadState(){this.UNKNOWN=-1;this.IDLE=0;this.FAILURE=1;this.PAUSE=2;this.STOP=3;this.RESUME=4;this.START=5;this.CREATE=6;this.CHECK=7;this.DOWNLOADWITHCHECK=8;this.DOWNLOAD=9;this.DOWNLOADSTALLED=10;this.COMPLETE=11;this.SEED=12}DownloadState.prototype.nameFromId=function(a){return 0>a?"Unknown":"Idle Failure Paused Stopping Resuming Starting Creating Checking DownloadingChecking Downloading DownloadingStalled Complete Seeding".split(" ")[a]};
var downloadState=new DownloadState;
function DownloadView(a,b,c){var d=this;this.instanceId=app.expandString("{Guid}");this.launchElement=this.resumeElement=this.pauseElement=this.titleElement=this.progressElement=this.progressBarElement=this.uploadSpeedElement=this.transferSpeedElement=this.bytesLeftElement=this.timeEstElement=this.deliveryMethodElement=this.statusElement=this.rootElement=null;this.normalizeProgress=!1;isNull(c)?(this.ownsController=!0,this.controller=a.controller):(this.ownsController=!1,this.controller=c);this.observers=
[];this.observers.push(notificationCenter.addInstanceObserver("Task","Start",a,function(c,b){d.onStart(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Workflow","WillUnload",workflow,function(c,b){d.onWorkflowUnload(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("DownloadTask","Launch",a,function(c,b){d.onDownloadTaskLaunch(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("DownloadTask","LaunchComplete",a,function(c,b){d.onDownloadTaskLaunchComplete(a,
b)}));this.observers.push(notificationCenter.addInstanceObserver("Download","Stop",this.controller.getDownload(),function(c,b){d.onDownloadStop(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Download","Complete",this.controller.getDownload(),function(c,b){d.onDownloadComplete(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Download","ConfigComplete",this.controller.getDownload(),function(c,b){d.onDownloadConfigComplete(a,b)}));this.observers.push(notificationCenter.addInstanceObserver("Download",
"StateChange",this.controller.getDownload(),function(c,b){d.onDownloadStateChange(a,b)}))}
DownloadView.prototype.release=function(){this.observers.forEach(function(a){a.release()});this.observers=[];this.onTimerStop();isNull(this.rootElementClass)||(this.rootElementClass.release(),this.rootElementClass=null);isNull(this.rootElementLaunchClass)||(this.rootElementLaunchClass.release(),this.rootElementLaunchClass=null);isNull(this.progressBarElementClass)||(this.progressBarElementClass.release(),this.progressBarElementClass=null);isNull(this.controller)||(!0===this.ownsController&&this.controller.release(),
this.controller=null)};
DownloadView.prototype.onStart=function(a){hasOwnProperty(a.args,"normalizeProgress")&&(this.normalizeProgress=a.args.normalizeProgress);notificationCenter.fire("DownloadView","Bind",a,this);host.assert(!isNull(this.rootElement),"DownloadView binding did not assign root element");this.rootElementClass=new ChangeClass(this.rootElement);this.rootElementLaunchClass=new ChangeClass(this.rootElement);isNull(this.progressBarElement)||(this.progressBarElementClass=new ChangeClass(this.progressBarElement));isNull(this.pauseElement)||
this.pauseElement.unbind(".downloadview");isNull(this.resumeElement)||this.resumeElement.unbind(".downloadview");isNull(this.launchElement)||this.launchElement.unbind(".downloadview");isNull(this.pauseElement)||this.pauseElement.bind("click.downloadview",null,function(){a.controller.getDownload().getState()!==downloadState.PAUSE&&a.controller.getDownload().setActive(false)});isNull(this.resumeElement)||this.resumeElement.bind("click.downloadview",null,function(){a.controller.getDownload().getState()===
downloadState.PAUSE&&a.controller.getDownload().setActive(true)});isNull(this.launchElement)||this.launchElement.bind("click.downloadview",null,function(){a.controller.launch(a)});this.onChangeClass("downloadStateInitializing");this.onUpdateStatus(host.getLanguageString("DownloadState_Initializing"));this.onUpdateProgressInternal(-1,downloadState.IDLE)};DownloadView.prototype.onWorkflowUnload=function(){this.release()};DownloadView.prototype.onDownloadStop=function(){this.onTimerStop()};
DownloadView.prototype.onTimerDownload=function(a){var b=this.controller.getDownload(),c,d=interop.parseJSON(b.getSessionState()),e=interop.parseJSON(b.getTransferRates());if(a===downloadState.DOWNLOADSTALLED)this.onUpdateStatus(host.getLanguageString("DownloadStalled_"+downloadStallReason.nameFromId(b.getStallReason())));isNull(d)||(c=downloadSessionStateFlag.connectivityFromId(d.flags),0<c.length&&(c="DownloadConnectivity_"+c));this.onUpdateDeliveryMethod(host.getLanguageString(c));this.onUpdateTimeEst(messageFormat.getTimeEstimate(b.getRemainingTime()));
this.onUpdateBytesLeft(messageFormat.getBytesLeft(b.getBytesLeft()));this.onUpdateTransferSpeed(messageFormat.getTransferSpeed(e.incoming.average));this.onUpdateUploadSpeed(messageFormat.getTransferSpeed(e.outgoing.average));this.onUpdateProgressInternal(b.getStateProgress(),b.getState())};DownloadView.prototype.onTimerStart=function(){var a=this;isNull(this.timerId)&&(this.timerId=setInterval(function(){a.onTimer()},250))};
DownloadView.prototype.onTimerStop=function(){isNull(this.timerId)||(clearInterval(this.timerId),this.timerId=null)};DownloadView.prototype.onTimer=function(){var a=this.controller.getDownload().getState();switch(a){case downloadState.CREATE:case downloadState.CHECK:case downloadState.DOWNLOADWITHCHECK:case downloadState.DOWNLOAD:case downloadState.DOWNLOADSTALLED:case downloadState.SEED:this.onTimerDownload(a)}};
DownloadView.prototype.onUpdateElement=function(a,b){if(!isNull(a)){var c=a.html();c!==b&&(a.html(b),a.trigger("changed",[c,b]))}};DownloadView.prototype.onUpdateTitle=function(a){this.onUpdateElement(this.titleElement,a)};DownloadView.prototype.onUpdateStatus=function(a){this.onUpdateElement(this.statusElement,a)};DownloadView.prototype.onUpdateTimeEst=function(a){this.onUpdateElement(this.timeEstElement,a)};
DownloadView.prototype.onUpdateBytesLeft=function(a){this.onUpdateElement(this.bytesLeftElement,a)};DownloadView.prototype.onUpdateDeliveryMethod=function(a){this.onUpdateElement(this.deliveryMethodElement,a)};DownloadView.prototype.onUpdateTransferSpeed=function(a){this.onUpdateElement(this.transferSpeedElement,a)};DownloadView.prototype.onUpdateUploadSpeed=function(a){this.onUpdateElement(this.uploadSpeedElement,a)};
DownloadView.prototype.onUpdateProgress=function(a){a={percent:parseInt(100*a,10)};notificationCenter.fire("TaskView","WillUpdateProgress",this,a);if((!isNull(this.progressElement)||!isNull(this.progressBarElement))&&a.percent!==this.lastPercent)this.lastPercent=a.percent,this.onUpdateElement(this.progressElement,Math.max(a.percent,0)+"%"),isNull(this.progressBarElement)||(0>a.percent?(this.progressBarElement.width("100%"),this.progressBarElementClass.apply("indefinite")):(this.progressBarElementClass.apply(null),
!0===host.isIE6?this.progressBarElement.width(Math.max(a.percent,1)+"%"):this.progressBarElement.width(a.percent+"%")),this.progressBarElement.trigger("updateProgress",a.percent))};
DownloadView.prototype.onUpdateProgressInternal=function(a,b){var c=0,d=0,e=[0,0,0,0,0,0,0,0.2,0,0.8,0,0,0];if(this.normalizeProgress){if(!(-1>=a)){b==downloadState.CHECK?this.progressEnteredCheckState=!0:b<downloadState.CHECK&&(this.progressEnteredCheckState=!1);for(d=0;d<e.length&&d!==b;d+=1){if(d==downloadState.CHECK&&(isNull(this.progressEnteredCheckState)||!this.progressEnteredCheckState))e[downloadState.DOWNLOAD]+=e[downloadState.CHECK],e[downloadState.CHECK]=0;c+=e[d]}c+=e[d]*parseFloat(a);
this.onUpdateProgress(c)}}else this.onUpdateProgress(a)};DownloadView.prototype.onDownloadConfigComplete=function(a){var b=this.controller.getDownload();if(hasOwnProperty(a.args,"title"))this.onUpdateTitle(b.expandString(a.args.title))};DownloadView.prototype.onDownloadComplete=function(a,b){var c=this.controller.getDownload();if(!1===b.successful)this.onUpdateStatus(host.getLanguageString("DownloadError_"+downloadError.nameFromId(c.getLastError())))};
DownloadView.prototype.onDownloadStateChange=function(a,b){var c=this.controller.getDownload();this.onChangeClass("downloadState"+downloadState.nameFromId(b.state));if(b.state>=downloadState.CREATE&&b.state!==downloadState.COMPLETE)this.onTimerStart();else this.onTimerStop();this.onUpdateStatus(host.getLanguageString("DownloadState_"+downloadState.nameFromId(b.state)));this.onUpdateProgressInternal(c.getStateProgress(),c.getState())};DownloadView.prototype.onDownloadTaskLaunch=function(){this.rootElementLaunchClass.apply("launchStateRunning")};
DownloadView.prototype.onDownloadTaskLaunchComplete=function(a,b){if(b.launchTask.hasError())this.rootElementLaunchClass.apply("launchStateError"),this.onUpdateStatus(host.getLanguageString(b.launchTask.getFirstErrorMessage()));else if(b.launchTask.hasWarning())this.rootElementLaunchClass.apply("launchStateWarning"),this.onUpdateStatus(host.getLanguageString(b.launchTask.getFirstWarningMessage()));else if(this.rootElementLaunchClass.apply("launchStateComplete"),hasOwnProperty(a.args,"launchCompleteMessage"))this.onUpdateStatus(host.getLanguageString(a.args.launchCompleteMessage))};
DownloadView.prototype.onChangeClass=function(a){this.rootElementClass.apply(a)};registerTaskView("download",DownloadView);function HttpRequest(a){this.instanceId=a}HttpRequest.prototype.release=function(){interop.releaseInstance(this.instanceId)};HttpRequest.prototype.getUseCache=function(){return interop.invoke(this.instanceId,{method:"getUseCache"})};HttpRequest.prototype.setUseCache=function(a){return interop.invoke(this.instanceId,{method:"setUseCache",value:a})};
HttpRequest.prototype.getValidate=function(){return interop.invoke(this.instanceId,{method:"getValidate"})};HttpRequest.prototype.setValidate=function(a){return interop.invoke(this.instanceId,{method:"setValidate",value:a})};HttpRequest.prototype.getType=function(){return interop.invoke(this.instanceId,{method:"getType"})};HttpRequest.prototype.setType=function(a){return interop.invoke(this.instanceId,{method:"setType",value:a})};
HttpRequest.prototype.getLimitBodySize=function(){return interop.invoke(this.instanceId,{method:"getLimitBodySize"})};HttpRequest.prototype.setLimitBodySize=function(a){return interop.invoke(this.instanceId,{method:"setLimitBodySize",value:a})};HttpRequest.prototype.getUrl=function(){return interop.invoke(this.instanceId,{method:"getUrl"})};HttpRequest.prototype.setUrl=function(a){return interop.invoke(this.instanceId,{method:"setUrl",value:a})};
HttpRequest.prototype.getFileName=function(){return interop.invoke(this.instanceId,{method:"getFileName"})};HttpRequest.prototype.setFileName=function(a){return interop.invoke(this.instanceId,{method:"setFileName",value:a})};HttpRequest.prototype.getRetryCount=function(){return interop.invoke(this.instanceId,{method:"getRetryCount"})};HttpRequest.prototype.setRetryCount=function(a){return interop.invoke(this.instanceId,{method:"setRetryCount",value:a})};
HttpRequest.prototype.getCleanup=function(){return interop.invoke(this.instanceId,{method:"getCleanup"})};HttpRequest.prototype.setCleanup=function(a){return interop.invoke(this.instanceId,{method:"setCleanup",value:a})};HttpRequest.prototype.getConnectTimeout=function(){return interop.invoke(this.instanceId,{method:"getConnectTimeout"})};HttpRequest.prototype.setConnectTimeout=function(a){return interop.invoke(this.instanceId,{method:"setConnectTimeout",value:a})};
HttpRequest.prototype.getHttpCode=function(){return interop.invoke(this.instanceId,{method:"getHttpCode"})};HttpRequest.prototype.getRawHttpCode=function(){return interop.invoke(this.instanceId,{method:"getRawHttpCode"})};HttpRequest.prototype.getContentLength=function(){return interop.invoke(this.instanceId,{method:"getContentLength"})};HttpRequest.prototype.getFilePosition=function(){return interop.invoke(this.instanceId,{method:"getFilePosition"})};
HttpRequest.prototype.getHeaderSize=function(){return interop.invoke(this.instanceId,{method:"getHeaderSize"})};HttpRequest.prototype.getBodySize=function(){return interop.invoke(this.instanceId,{method:"getBodySize"})};HttpRequest.prototype.start=function(){return interop.invoke(this.instanceId,{method:"start"})};HttpRequest.prototype.reset=function(){return interop.invoke(this.instanceId,{method:"reset"})};HttpRequest.prototype.abort=function(){return interop.invoke(this.instanceId,{method:"abort"})};
HttpRequest.prototype.validate=function(a){return interop.invoke(this.instanceId,{method:"validate",successful:a})};HttpRequest.prototype.getBody=function(a,b){return interop.invoke(this.instanceId,{method:"getBody",offset:a,length:b})};HttpRequest.prototype.clearPostData=function(){return interop.invoke(this.instanceId,{method:"clearPostData"})};HttpRequest.prototype.appendPostData=function(a){return interop.invoke(this.instanceId,{method:"appendPostData",postData:a})};
HttpRequest.prototype.setByteRange=function(a,b){return interop.invoke(this.instanceId,{method:"setByteRange",start:a,end:b})};HttpRequest.prototype.headerExists=function(a){return interop.invoke(this.instanceId,{method:"headerExists",name:a})};HttpRequest.prototype.getHeader=function(a,b){return interop.invoke(this.instanceId,{method:"getHeader",offset:a,length:b})};HttpRequest.prototype.getHeaderValue=function(a){return interop.invoke(this.instanceId,{method:"getHeaderValue",name:a})};
HttpRequest.prototype.setHeaderValue=function(a,b){return interop.invoke(this.instanceId,{method:"setHeaderValue",name:a,value:b})};function createHttpRequest(){return interop.createInstance("SSN.HttpRequest",HttpRequest)}function HttpRequestType(){this.UNKNOWN=0;this.GET=1;this.POST=2;this.PUT=3;this.DELETE=4;this.HEAD=5}HttpRequestType.prototype.nameFromId=function(a){return"Unknown Get Post Put Delete Head".split(" ")[a]};var httpRequestType=new HttpRequestType;
function HttpRequestXhr(){this.readyState=HttpRequestXhr.IDLE;this.responseText="";this.responseXML=null;this.status=0;this.statusText="";this.onreadystatechange=function(){};this.httpRequest=null;this.observers=[];this.pendingFunctions=[];this.pendingIntervalId=null}
HttpRequestXhr.prototype.internalCreateConnection=function(){var a=this;isNull(this.httpRequest)?(this.httpRequest=createHttpRequest(),this.httpRequest.setUseCache(!1),this.httpRequest.setRetryCount(1),this.observers.push(notificationCenter.addInstanceObserver("HttpRequest","HeaderDone",this.httpRequest,function(b,c){a.onHeaderDone(b,c)})),this.observers.push(notificationCenter.addInstanceObserver("HttpRequest","Complete",this.httpRequest,function(b,c){a.onRequestComplete(b,c)}))):this.httpRequest.reset()};
HttpRequestXhr.prototype.internalClose=function(){isNull(this.pendingIntervalId)||(clearInterval(this.pendingIntervalId),this.pendingIntervalId=null);this.pendingFunctions=[];this.observers.forEach(function(a){a.release()});this.observers=[];isNull(this.httpRequest)||(this.httpRequest.release(),this.httpRequest=null)};
HttpRequestXhr.prototype.pendFunction=function(a){var b=this;this.pendingFunctions.push(a);isNull(this.pendingIntervalId)&&(this.pendingIntervalId=setInterval(function(){!1!==interop.isInteropLoaded("downloader")&&(clearInterval(b.pendingIntervalId),b.pendingIntervalId=null,b.pendingFunctions.forEach(function(a){a()}),b.pendingFunctions=[])},250))};HttpRequestXhr.prototype.onHeaderDone=function(){this.changeReadyState(HttpRequestXhr.HEADERDONE);this.changeReadyState(HttpRequestXhr.BODY)};
HttpRequestXhr.prototype.onRequestComplete=function(){var a=0,b,c=this;this.status=this.httpRequest.getHttpCode();do b=app.base64Decode(this.httpRequest.getBody(a,4E3)),this.responseText=this.responseText.concat(b),a+=4E3;while(0<b.length);b=null;try{this.responseXML=$.parseXML(this.responseText)}catch(d){this.responseXML=null}this.changeReadyState(HttpRequestXhr.COMPLETE);isNull(this.httpRequest)||setTimeout(function(){c.internalClose()},0)};
HttpRequestXhr.prototype.changeReadyState=function(a){this.readyState=a;this.onreadystatechange()};
HttpRequestXhr.prototype.open=function(a,b,c,d,e){var f=this;if(!1===interop.isInteropLoaded("downloader"))this.pendFunction(function(){f.open(a,b,c,d,e)});else{this.internalCreateConnection();host.assert(!0===c,"Synchronous request not supported");a=a.toLowerCase();switch(a){case "get":this.httpRequest.setType(httpRequestType.GET);break;case "post":this.httpRequest.setType(httpRequestType.POST);break;case "put":this.httpRequest.setType(httpRequestType.PUT);break;case "delete":this.httpRequest.setType(httpRequestType.DELETE);
break;case "head":this.httpRequest.setType(httpRequestType.HEAD);break;default:host.assert(!1,"Unsupported request type ({0})".format(a));return}this.httpRequest.setUrl(b);this.changeReadyState(HttpRequestXhr.OPEN)}};HttpRequestXhr.prototype.send=function(a){var b=this,c=0,d;if(!1===interop.isInteropLoaded("downloader"))this.pendFunction(function(){b.send(a)});else{if(!isNull(a))for(d=a.toString();c<d.length;)this.httpRequest.appendPostData(app.base64Encode(d.substring(c,c+8E3))),c+=8E3;this.httpRequest.start()}};
HttpRequestXhr.prototype.abort=function(){isNull(this.httpRequest)||this.internalClose()};HttpRequestXhr.prototype.overrideMimeType=function(){};HttpRequestXhr.prototype.getAllResponseHeaders=function(){host.assert(!isNull(this.httpRequest),"HttpRequest object does not exist");var a=0,b,c="";do b=app.base64Decode(this.httpRequest.getHeader(a,4E3)),c+=b,a+=4E3;while(0<b.length);return c};
HttpRequestXhr.prototype.getResponseHeader=function(a){host.assert(!isNull(this.httpRequest),"HttpRequest object does not exist");return this.httpRequest.getHeaderValue(a)};HttpRequestXhr.prototype.setRequestHeader=function(a,b){var c=this;!1===interop.isInteropLoaded("downloader")?this.pendFunction(function(){c.setRequestHeader(a,b)}):this.httpRequest.setHeaderValue(a,b)};HttpRequestXhr.IDLE=0;HttpRequestXhr.OPEN=1;HttpRequestXhr.HEADERDONE=2;HttpRequestXhr.BODY=3;HttpRequestXhr.COMPLETE=4;
(function(){jQuery.ajaxSetup({converters:{"text script":function(a){return a}},crossDomain:!1,xhr:function(){return new HttpRequestXhr}})})();
